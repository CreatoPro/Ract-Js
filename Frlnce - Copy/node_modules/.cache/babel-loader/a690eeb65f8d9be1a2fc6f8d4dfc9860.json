{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _core = require(\"../../utils/core\");\n\nvar _throttle = _interopRequireDefault(require(\"lodash/throttle\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nclass Stage {\n  constructor(_options) {\n    this.settings = _options || {};\n    this.id = \"epubjs-container-\" + (0, _core.uuid)();\n    this.container = this.create(this.settings);\n\n    if (this.settings.hidden) {\n      this.wrapper = this.wrap(this.container);\n    }\n  }\n  /*\n  * Creates an element to render to.\n  * Resizes to passed width and height or to the elements size\n  */\n\n\n  create(options) {\n    let height = options.height; // !== false ? options.height : \"100%\";\n\n    let width = options.width; // !== false ? options.width : \"100%\";\n\n    let overflow = options.overflow || false;\n    let axis = options.axis || \"vertical\";\n    let direction = options.direction;\n    (0, _core.extend)(this.settings, options);\n\n    if (options.height && (0, _core.isNumber)(options.height)) {\n      height = options.height + \"px\";\n    }\n\n    if (options.width && (0, _core.isNumber)(options.width)) {\n      width = options.width + \"px\";\n    } // Create new container element\n\n\n    let container = document.createElement(\"div\");\n    container.id = this.id;\n    container.classList.add(\"epub-container\"); // Style Element\n    // container.style.fontSize = \"0\";\n\n    container.style.wordSpacing = \"0\";\n    container.style.lineHeight = \"0\";\n    container.style.verticalAlign = \"top\";\n    container.style.position = \"relative\";\n\n    if (axis === \"horizontal\") {\n      // container.style.whiteSpace = \"nowrap\";\n      container.style.display = \"flex\";\n      container.style.flexDirection = \"row\";\n      container.style.flexWrap = \"nowrap\";\n    }\n\n    if (width) {\n      container.style.width = width;\n    }\n\n    if (height) {\n      container.style.height = height;\n    }\n\n    if (overflow) {\n      if (overflow === \"scroll\" && axis === \"vertical\") {\n        container.style[\"overflow-y\"] = overflow;\n        container.style[\"overflow-x\"] = \"hidden\";\n      } else if (overflow === \"scroll\" && axis === \"horizontal\") {\n        container.style[\"overflow-y\"] = \"hidden\";\n        container.style[\"overflow-x\"] = overflow;\n      } else {\n        container.style[\"overflow\"] = overflow;\n      }\n    }\n\n    if (direction) {\n      container.dir = direction;\n      container.style[\"direction\"] = direction;\n    }\n\n    if (direction && this.settings.fullsize) {\n      document.body.style[\"direction\"] = direction;\n    }\n\n    return container;\n  }\n\n  wrap(container) {\n    var wrapper = document.createElement(\"div\");\n    wrapper.style.visibility = \"hidden\";\n    wrapper.style.overflow = \"hidden\";\n    wrapper.style.width = \"0\";\n    wrapper.style.height = \"0\";\n    wrapper.appendChild(container);\n    return wrapper;\n  }\n\n  getElement(_element) {\n    var element;\n\n    if ((0, _core.isElement)(_element)) {\n      element = _element;\n    } else if (typeof _element === \"string\") {\n      element = document.getElementById(_element);\n    }\n\n    if (!element) {\n      throw new Error(\"Not an Element\");\n    }\n\n    return element;\n  }\n\n  attachTo(what) {\n    var element = this.getElement(what);\n    var base;\n\n    if (!element) {\n      return;\n    }\n\n    if (this.settings.hidden) {\n      base = this.wrapper;\n    } else {\n      base = this.container;\n    }\n\n    element.appendChild(base);\n    this.element = element;\n    return element;\n  }\n\n  getContainer() {\n    return this.container;\n  }\n\n  onResize(func) {\n    // Only listen to window for resize event if width and height are not fixed.\n    // This applies if it is set to a percent or auto.\n    if (!(0, _core.isNumber)(this.settings.width) || !(0, _core.isNumber)(this.settings.height)) {\n      this.resizeFunc = (0, _throttle.default)(func, 50);\n      window.addEventListener(\"resize\", this.resizeFunc, false);\n    }\n  }\n\n  onOrientationChange(func) {\n    this.orientationChangeFunc = func;\n    window.addEventListener(\"orientationchange\", this.orientationChangeFunc, false);\n  }\n\n  size(width, height) {\n    var bounds;\n\n    let _width = width || this.settings.width;\n\n    let _height = height || this.settings.height; // If width or height are set to false, inherit them from containing element\n\n\n    if (width === null) {\n      bounds = this.element.getBoundingClientRect();\n\n      if (bounds.width) {\n        width = Math.floor(bounds.width);\n        this.container.style.width = width + \"px\";\n      }\n    } else {\n      if ((0, _core.isNumber)(width)) {\n        this.container.style.width = width + \"px\";\n      } else {\n        this.container.style.width = width;\n      }\n    }\n\n    if (height === null) {\n      bounds = bounds || this.element.getBoundingClientRect();\n\n      if (bounds.height) {\n        height = bounds.height;\n        this.container.style.height = height + \"px\";\n      }\n    } else {\n      if ((0, _core.isNumber)(height)) {\n        this.container.style.height = height + \"px\";\n      } else {\n        this.container.style.height = height;\n      }\n    }\n\n    if (!(0, _core.isNumber)(width)) {\n      width = this.container.clientWidth;\n    }\n\n    if (!(0, _core.isNumber)(height)) {\n      height = this.container.clientHeight;\n    }\n\n    this.containerStyles = window.getComputedStyle(this.container);\n    this.containerPadding = {\n      left: parseFloat(this.containerStyles[\"padding-left\"]) || 0,\n      right: parseFloat(this.containerStyles[\"padding-right\"]) || 0,\n      top: parseFloat(this.containerStyles[\"padding-top\"]) || 0,\n      bottom: parseFloat(this.containerStyles[\"padding-bottom\"]) || 0\n    }; // Bounds not set, get them from window\n\n    let _windowBounds = (0, _core.windowBounds)();\n\n    let bodyStyles = window.getComputedStyle(document.body);\n    let bodyPadding = {\n      left: parseFloat(bodyStyles[\"padding-left\"]) || 0,\n      right: parseFloat(bodyStyles[\"padding-right\"]) || 0,\n      top: parseFloat(bodyStyles[\"padding-top\"]) || 0,\n      bottom: parseFloat(bodyStyles[\"padding-bottom\"]) || 0\n    };\n\n    if (!_width) {\n      width = _windowBounds.width - bodyPadding.left - bodyPadding.right;\n    }\n\n    if (this.settings.fullsize && !_height || !_height) {\n      height = _windowBounds.height - bodyPadding.top - bodyPadding.bottom;\n    }\n\n    return {\n      width: width - this.containerPadding.left - this.containerPadding.right,\n      height: height - this.containerPadding.top - this.containerPadding.bottom\n    };\n  }\n\n  bounds() {\n    let box;\n\n    if (this.container.style.overflow !== \"visible\") {\n      box = this.container && this.container.getBoundingClientRect();\n    }\n\n    if (!box || !box.width || !box.height) {\n      return (0, _core.windowBounds)();\n    } else {\n      return box;\n    }\n  }\n\n  getSheet() {\n    var style = document.createElement(\"style\"); // WebKit hack --> https://davidwalsh.name/add-rules-stylesheets\n\n    style.appendChild(document.createTextNode(\"\"));\n    document.head.appendChild(style);\n    return style.sheet;\n  }\n\n  addStyleRules(selector, rulesArray) {\n    var scope = \"#\" + this.id + \" \";\n    var rules = \"\";\n\n    if (!this.sheet) {\n      this.sheet = this.getSheet();\n    }\n\n    rulesArray.forEach(function (set) {\n      for (var prop in set) {\n        if (set.hasOwnProperty(prop)) {\n          rules += prop + \":\" + set[prop] + \";\";\n        }\n      }\n    });\n    this.sheet.insertRule(scope + selector + \" {\" + rules + \"}\", 0);\n  }\n\n  axis(axis) {\n    if (axis === \"horizontal\") {\n      this.container.style.display = \"flex\";\n      this.container.style.flexDirection = \"row\";\n      this.container.style.flexWrap = \"nowrap\";\n    } else {\n      this.container.style.display = \"block\";\n    }\n\n    this.settings.axis = axis;\n  } // orientation(orientation) {\n  // \tif (orientation === \"landscape\") {\n  //\n  // \t} else {\n  //\n  // \t}\n  //\n  // \tthis.orientation = orientation;\n  // }\n\n\n  direction(dir) {\n    if (this.container) {\n      this.container.dir = dir;\n      this.container.style[\"direction\"] = dir;\n    }\n\n    if (this.settings.fullsize) {\n      document.body.style[\"direction\"] = dir;\n    }\n\n    this.settings.dir = dir;\n  }\n\n  overflow(overflow) {\n    if (this.container) {\n      if (overflow === \"scroll\" && this.settings.axis === \"vertical\") {\n        this.container.style[\"overflow-y\"] = overflow;\n        this.container.style[\"overflow-x\"] = \"hidden\";\n      } else if (overflow === \"scroll\" && this.settings.axis === \"horizontal\") {\n        this.container.style[\"overflow-y\"] = \"hidden\";\n        this.container.style[\"overflow-x\"] = overflow;\n      } else {\n        this.container.style[\"overflow\"] = overflow;\n      }\n    }\n\n    this.settings.overflow = overflow;\n  }\n\n  destroy() {\n    var base;\n\n    if (this.element) {\n      if (this.settings.hidden) {\n        base = this.wrapper;\n      } else {\n        base = this.container;\n      }\n\n      if (this.element.contains(this.container)) {\n        this.element.removeChild(this.container);\n      }\n\n      window.removeEventListener(\"resize\", this.resizeFunc);\n      window.removeEventListener(\"orientationChange\", this.orientationChangeFunc);\n    }\n  }\n\n}\n\nvar _default = Stage;\nexports.default = _default;","map":{"version":3,"sources":["S:/REACT/Ract-Js/Frlnce/node_modules/epubjs/lib/managers/helpers/stage.js"],"names":["Object","defineProperty","exports","value","default","_core","require","_throttle","_interopRequireDefault","obj","__esModule","Stage","constructor","_options","settings","id","uuid","container","create","hidden","wrapper","wrap","options","height","width","overflow","axis","direction","extend","isNumber","document","createElement","classList","add","style","wordSpacing","lineHeight","verticalAlign","position","display","flexDirection","flexWrap","dir","fullsize","body","visibility","appendChild","getElement","_element","element","isElement","getElementById","Error","attachTo","what","base","getContainer","onResize","func","resizeFunc","window","addEventListener","onOrientationChange","orientationChangeFunc","size","bounds","_width","_height","getBoundingClientRect","Math","floor","clientWidth","clientHeight","containerStyles","getComputedStyle","containerPadding","left","parseFloat","right","top","bottom","_windowBounds","windowBounds","bodyStyles","bodyPadding","box","getSheet","createTextNode","head","sheet","addStyleRules","selector","rulesArray","scope","rules","forEach","set","prop","hasOwnProperty","insertRule","destroy","contains","removeChild","removeEventListener","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _core = require(\"../../utils/core\");\n\nvar _throttle = _interopRequireDefault(require(\"lodash/throttle\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nclass Stage {\n  constructor(_options) {\n    this.settings = _options || {};\n    this.id = \"epubjs-container-\" + (0, _core.uuid)();\n    this.container = this.create(this.settings);\n\n    if (this.settings.hidden) {\n      this.wrapper = this.wrap(this.container);\n    }\n  }\n  /*\n  * Creates an element to render to.\n  * Resizes to passed width and height or to the elements size\n  */\n\n\n  create(options) {\n    let height = options.height; // !== false ? options.height : \"100%\";\n\n    let width = options.width; // !== false ? options.width : \"100%\";\n\n    let overflow = options.overflow || false;\n    let axis = options.axis || \"vertical\";\n    let direction = options.direction;\n    (0, _core.extend)(this.settings, options);\n\n    if (options.height && (0, _core.isNumber)(options.height)) {\n      height = options.height + \"px\";\n    }\n\n    if (options.width && (0, _core.isNumber)(options.width)) {\n      width = options.width + \"px\";\n    } // Create new container element\n\n\n    let container = document.createElement(\"div\");\n    container.id = this.id;\n    container.classList.add(\"epub-container\"); // Style Element\n    // container.style.fontSize = \"0\";\n\n    container.style.wordSpacing = \"0\";\n    container.style.lineHeight = \"0\";\n    container.style.verticalAlign = \"top\";\n    container.style.position = \"relative\";\n\n    if (axis === \"horizontal\") {\n      // container.style.whiteSpace = \"nowrap\";\n      container.style.display = \"flex\";\n      container.style.flexDirection = \"row\";\n      container.style.flexWrap = \"nowrap\";\n    }\n\n    if (width) {\n      container.style.width = width;\n    }\n\n    if (height) {\n      container.style.height = height;\n    }\n\n    if (overflow) {\n      if (overflow === \"scroll\" && axis === \"vertical\") {\n        container.style[\"overflow-y\"] = overflow;\n        container.style[\"overflow-x\"] = \"hidden\";\n      } else if (overflow === \"scroll\" && axis === \"horizontal\") {\n        container.style[\"overflow-y\"] = \"hidden\";\n        container.style[\"overflow-x\"] = overflow;\n      } else {\n        container.style[\"overflow\"] = overflow;\n      }\n    }\n\n    if (direction) {\n      container.dir = direction;\n      container.style[\"direction\"] = direction;\n    }\n\n    if (direction && this.settings.fullsize) {\n      document.body.style[\"direction\"] = direction;\n    }\n\n    return container;\n  }\n\n  wrap(container) {\n    var wrapper = document.createElement(\"div\");\n    wrapper.style.visibility = \"hidden\";\n    wrapper.style.overflow = \"hidden\";\n    wrapper.style.width = \"0\";\n    wrapper.style.height = \"0\";\n    wrapper.appendChild(container);\n    return wrapper;\n  }\n\n  getElement(_element) {\n    var element;\n\n    if ((0, _core.isElement)(_element)) {\n      element = _element;\n    } else if (typeof _element === \"string\") {\n      element = document.getElementById(_element);\n    }\n\n    if (!element) {\n      throw new Error(\"Not an Element\");\n    }\n\n    return element;\n  }\n\n  attachTo(what) {\n    var element = this.getElement(what);\n    var base;\n\n    if (!element) {\n      return;\n    }\n\n    if (this.settings.hidden) {\n      base = this.wrapper;\n    } else {\n      base = this.container;\n    }\n\n    element.appendChild(base);\n    this.element = element;\n    return element;\n  }\n\n  getContainer() {\n    return this.container;\n  }\n\n  onResize(func) {\n    // Only listen to window for resize event if width and height are not fixed.\n    // This applies if it is set to a percent or auto.\n    if (!(0, _core.isNumber)(this.settings.width) || !(0, _core.isNumber)(this.settings.height)) {\n      this.resizeFunc = (0, _throttle.default)(func, 50);\n      window.addEventListener(\"resize\", this.resizeFunc, false);\n    }\n  }\n\n  onOrientationChange(func) {\n    this.orientationChangeFunc = func;\n    window.addEventListener(\"orientationchange\", this.orientationChangeFunc, false);\n  }\n\n  size(width, height) {\n    var bounds;\n\n    let _width = width || this.settings.width;\n\n    let _height = height || this.settings.height; // If width or height are set to false, inherit them from containing element\n\n\n    if (width === null) {\n      bounds = this.element.getBoundingClientRect();\n\n      if (bounds.width) {\n        width = Math.floor(bounds.width);\n        this.container.style.width = width + \"px\";\n      }\n    } else {\n      if ((0, _core.isNumber)(width)) {\n        this.container.style.width = width + \"px\";\n      } else {\n        this.container.style.width = width;\n      }\n    }\n\n    if (height === null) {\n      bounds = bounds || this.element.getBoundingClientRect();\n\n      if (bounds.height) {\n        height = bounds.height;\n        this.container.style.height = height + \"px\";\n      }\n    } else {\n      if ((0, _core.isNumber)(height)) {\n        this.container.style.height = height + \"px\";\n      } else {\n        this.container.style.height = height;\n      }\n    }\n\n    if (!(0, _core.isNumber)(width)) {\n      width = this.container.clientWidth;\n    }\n\n    if (!(0, _core.isNumber)(height)) {\n      height = this.container.clientHeight;\n    }\n\n    this.containerStyles = window.getComputedStyle(this.container);\n    this.containerPadding = {\n      left: parseFloat(this.containerStyles[\"padding-left\"]) || 0,\n      right: parseFloat(this.containerStyles[\"padding-right\"]) || 0,\n      top: parseFloat(this.containerStyles[\"padding-top\"]) || 0,\n      bottom: parseFloat(this.containerStyles[\"padding-bottom\"]) || 0\n    }; // Bounds not set, get them from window\n\n    let _windowBounds = (0, _core.windowBounds)();\n\n    let bodyStyles = window.getComputedStyle(document.body);\n    let bodyPadding = {\n      left: parseFloat(bodyStyles[\"padding-left\"]) || 0,\n      right: parseFloat(bodyStyles[\"padding-right\"]) || 0,\n      top: parseFloat(bodyStyles[\"padding-top\"]) || 0,\n      bottom: parseFloat(bodyStyles[\"padding-bottom\"]) || 0\n    };\n\n    if (!_width) {\n      width = _windowBounds.width - bodyPadding.left - bodyPadding.right;\n    }\n\n    if (this.settings.fullsize && !_height || !_height) {\n      height = _windowBounds.height - bodyPadding.top - bodyPadding.bottom;\n    }\n\n    return {\n      width: width - this.containerPadding.left - this.containerPadding.right,\n      height: height - this.containerPadding.top - this.containerPadding.bottom\n    };\n  }\n\n  bounds() {\n    let box;\n\n    if (this.container.style.overflow !== \"visible\") {\n      box = this.container && this.container.getBoundingClientRect();\n    }\n\n    if (!box || !box.width || !box.height) {\n      return (0, _core.windowBounds)();\n    } else {\n      return box;\n    }\n  }\n\n  getSheet() {\n    var style = document.createElement(\"style\"); // WebKit hack --> https://davidwalsh.name/add-rules-stylesheets\n\n    style.appendChild(document.createTextNode(\"\"));\n    document.head.appendChild(style);\n    return style.sheet;\n  }\n\n  addStyleRules(selector, rulesArray) {\n    var scope = \"#\" + this.id + \" \";\n    var rules = \"\";\n\n    if (!this.sheet) {\n      this.sheet = this.getSheet();\n    }\n\n    rulesArray.forEach(function (set) {\n      for (var prop in set) {\n        if (set.hasOwnProperty(prop)) {\n          rules += prop + \":\" + set[prop] + \";\";\n        }\n      }\n    });\n    this.sheet.insertRule(scope + selector + \" {\" + rules + \"}\", 0);\n  }\n\n  axis(axis) {\n    if (axis === \"horizontal\") {\n      this.container.style.display = \"flex\";\n      this.container.style.flexDirection = \"row\";\n      this.container.style.flexWrap = \"nowrap\";\n    } else {\n      this.container.style.display = \"block\";\n    }\n\n    this.settings.axis = axis;\n  } // orientation(orientation) {\n  // \tif (orientation === \"landscape\") {\n  //\n  // \t} else {\n  //\n  // \t}\n  //\n  // \tthis.orientation = orientation;\n  // }\n\n\n  direction(dir) {\n    if (this.container) {\n      this.container.dir = dir;\n      this.container.style[\"direction\"] = dir;\n    }\n\n    if (this.settings.fullsize) {\n      document.body.style[\"direction\"] = dir;\n    }\n\n    this.settings.dir = dir;\n  }\n\n  overflow(overflow) {\n    if (this.container) {\n      if (overflow === \"scroll\" && this.settings.axis === \"vertical\") {\n        this.container.style[\"overflow-y\"] = overflow;\n        this.container.style[\"overflow-x\"] = \"hidden\";\n      } else if (overflow === \"scroll\" && this.settings.axis === \"horizontal\") {\n        this.container.style[\"overflow-y\"] = \"hidden\";\n        this.container.style[\"overflow-x\"] = overflow;\n      } else {\n        this.container.style[\"overflow\"] = overflow;\n      }\n    }\n\n    this.settings.overflow = overflow;\n  }\n\n  destroy() {\n    var base;\n\n    if (this.element) {\n      if (this.settings.hidden) {\n        base = this.wrapper;\n      } else {\n        base = this.container;\n      }\n\n      if (this.element.contains(this.container)) {\n        this.element.removeChild(this.container);\n      }\n\n      window.removeEventListener(\"resize\", this.resizeFunc);\n      window.removeEventListener(\"orientationChange\", this.orientationChangeFunc);\n    }\n  }\n\n}\n\nvar _default = Stage;\nexports.default = _default;"]},"metadata":{},"sourceType":"script"}