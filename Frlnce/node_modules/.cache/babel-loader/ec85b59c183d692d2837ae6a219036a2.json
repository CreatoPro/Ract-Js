{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.replaceBase = replaceBase;\nexports.replaceCanonical = replaceCanonical;\nexports.replaceLinks = replaceLinks;\nexports.replaceMeta = replaceMeta;\nexports.substitute = substitute;\n\nvar _core = require(\"./core\");\n\nvar _url = _interopRequireDefault(require(\"./url\"));\n\nvar _path = _interopRequireDefault(require(\"./path\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction replaceBase(doc, section) {\n  var base;\n  var head;\n  var url = section.url;\n  var absolute = url.indexOf(\"://\") > -1;\n\n  if (!doc) {\n    return;\n  }\n\n  head = (0, _core.qs)(doc, \"head\");\n  base = (0, _core.qs)(head, \"base\");\n\n  if (!base) {\n    base = doc.createElement(\"base\");\n    head.insertBefore(base, head.firstChild);\n  } // Fix for Safari crashing if the url doesn't have an origin\n\n\n  if (!absolute && window && window.location) {\n    url = window.location.origin + url;\n  }\n\n  base.setAttribute(\"href\", url);\n}\n\nfunction replaceCanonical(doc, section) {\n  var head;\n  var link;\n  var url = section.canonical;\n\n  if (!doc) {\n    return;\n  }\n\n  head = (0, _core.qs)(doc, \"head\");\n  link = (0, _core.qs)(head, \"link[rel='canonical']\");\n\n  if (link) {\n    link.setAttribute(\"href\", url);\n  } else {\n    link = doc.createElement(\"link\");\n    link.setAttribute(\"rel\", \"canonical\");\n    link.setAttribute(\"href\", url);\n    head.appendChild(link);\n  }\n}\n\nfunction replaceMeta(doc, section) {\n  var head;\n  var meta;\n  var id = section.idref;\n\n  if (!doc) {\n    return;\n  }\n\n  head = (0, _core.qs)(doc, \"head\");\n  meta = (0, _core.qs)(head, \"link[property='dc.identifier']\");\n\n  if (meta) {\n    meta.setAttribute(\"content\", id);\n  } else {\n    meta = doc.createElement(\"meta\");\n    meta.setAttribute(\"name\", \"dc.identifier\");\n    meta.setAttribute(\"content\", id);\n    head.appendChild(meta);\n  }\n} // TODO: move me to Contents\n\n\nfunction replaceLinks(contents, fn) {\n  var links = contents.querySelectorAll(\"a[href]\");\n\n  if (!links.length) {\n    return;\n  }\n\n  var base = (0, _core.qs)(contents.ownerDocument, \"base\");\n  var location = base ? base.getAttribute(\"href\") : undefined;\n\n  var replaceLink = function (link) {\n    var href = link.getAttribute(\"href\");\n\n    if (href.indexOf(\"mailto:\") === 0) {\n      return;\n    }\n\n    var absolute = href.indexOf(\"://\") > -1;\n\n    if (absolute) {\n      link.setAttribute(\"target\", \"_blank\");\n    } else {\n      var linkUrl;\n\n      try {\n        linkUrl = new _url.default(href, location);\n      } catch (error) {// NOOP\n      }\n\n      link.onclick = function () {\n        if (linkUrl && linkUrl.hash) {\n          fn(linkUrl.Path.path + linkUrl.hash);\n        } else if (linkUrl) {\n          fn(linkUrl.Path.path);\n        } else {\n          fn(href);\n        }\n\n        return false;\n      };\n    }\n  }.bind(this);\n\n  for (var i = 0; i < links.length; i++) {\n    replaceLink(links[i]);\n  }\n}\n\nfunction substitute(content, urls, replacements) {\n  urls.forEach(function (url, i) {\n    if (url && replacements[i]) {\n      // Account for special characters in the file name.\n      // See https://stackoverflow.com/a/6318729.\n      url = url.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\n      content = content.replace(new RegExp(url, \"g\"), replacements[i]);\n    }\n  });\n  return content;\n}","map":{"version":3,"sources":["S:/REACT/Ract-Js/Frlnce/node_modules/epubjs/lib/utils/replacements.js"],"names":["Object","defineProperty","exports","value","replaceBase","replaceCanonical","replaceLinks","replaceMeta","substitute","_core","require","_url","_interopRequireDefault","_path","obj","__esModule","default","doc","section","base","head","url","absolute","indexOf","qs","createElement","insertBefore","firstChild","window","location","origin","setAttribute","link","canonical","appendChild","meta","id","idref","contents","fn","links","querySelectorAll","length","ownerDocument","getAttribute","undefined","replaceLink","href","linkUrl","error","onclick","hash","Path","path","bind","i","content","urls","replacements","forEach","replace","RegExp"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.replaceBase = replaceBase;\nexports.replaceCanonical = replaceCanonical;\nexports.replaceLinks = replaceLinks;\nexports.replaceMeta = replaceMeta;\nexports.substitute = substitute;\n\nvar _core = require(\"./core\");\n\nvar _url = _interopRequireDefault(require(\"./url\"));\n\nvar _path = _interopRequireDefault(require(\"./path\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction replaceBase(doc, section) {\n  var base;\n  var head;\n  var url = section.url;\n  var absolute = url.indexOf(\"://\") > -1;\n\n  if (!doc) {\n    return;\n  }\n\n  head = (0, _core.qs)(doc, \"head\");\n  base = (0, _core.qs)(head, \"base\");\n\n  if (!base) {\n    base = doc.createElement(\"base\");\n    head.insertBefore(base, head.firstChild);\n  } // Fix for Safari crashing if the url doesn't have an origin\n\n\n  if (!absolute && window && window.location) {\n    url = window.location.origin + url;\n  }\n\n  base.setAttribute(\"href\", url);\n}\n\nfunction replaceCanonical(doc, section) {\n  var head;\n  var link;\n  var url = section.canonical;\n\n  if (!doc) {\n    return;\n  }\n\n  head = (0, _core.qs)(doc, \"head\");\n  link = (0, _core.qs)(head, \"link[rel='canonical']\");\n\n  if (link) {\n    link.setAttribute(\"href\", url);\n  } else {\n    link = doc.createElement(\"link\");\n    link.setAttribute(\"rel\", \"canonical\");\n    link.setAttribute(\"href\", url);\n    head.appendChild(link);\n  }\n}\n\nfunction replaceMeta(doc, section) {\n  var head;\n  var meta;\n  var id = section.idref;\n\n  if (!doc) {\n    return;\n  }\n\n  head = (0, _core.qs)(doc, \"head\");\n  meta = (0, _core.qs)(head, \"link[property='dc.identifier']\");\n\n  if (meta) {\n    meta.setAttribute(\"content\", id);\n  } else {\n    meta = doc.createElement(\"meta\");\n    meta.setAttribute(\"name\", \"dc.identifier\");\n    meta.setAttribute(\"content\", id);\n    head.appendChild(meta);\n  }\n} // TODO: move me to Contents\n\n\nfunction replaceLinks(contents, fn) {\n  var links = contents.querySelectorAll(\"a[href]\");\n\n  if (!links.length) {\n    return;\n  }\n\n  var base = (0, _core.qs)(contents.ownerDocument, \"base\");\n  var location = base ? base.getAttribute(\"href\") : undefined;\n\n  var replaceLink = function (link) {\n    var href = link.getAttribute(\"href\");\n\n    if (href.indexOf(\"mailto:\") === 0) {\n      return;\n    }\n\n    var absolute = href.indexOf(\"://\") > -1;\n\n    if (absolute) {\n      link.setAttribute(\"target\", \"_blank\");\n    } else {\n      var linkUrl;\n\n      try {\n        linkUrl = new _url.default(href, location);\n      } catch (error) {// NOOP\n      }\n\n      link.onclick = function () {\n        if (linkUrl && linkUrl.hash) {\n          fn(linkUrl.Path.path + linkUrl.hash);\n        } else if (linkUrl) {\n          fn(linkUrl.Path.path);\n        } else {\n          fn(href);\n        }\n\n        return false;\n      };\n    }\n  }.bind(this);\n\n  for (var i = 0; i < links.length; i++) {\n    replaceLink(links[i]);\n  }\n}\n\nfunction substitute(content, urls, replacements) {\n  urls.forEach(function (url, i) {\n    if (url && replacements[i]) {\n      // Account for special characters in the file name.\n      // See https://stackoverflow.com/a/6318729.\n      url = url.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\n      content = content.replace(new RegExp(url, \"g\"), replacements[i]);\n    }\n  });\n  return content;\n}"]},"metadata":{},"sourceType":"script"}