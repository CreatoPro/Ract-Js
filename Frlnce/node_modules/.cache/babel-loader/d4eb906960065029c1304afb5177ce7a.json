{"ast":null,"code":"var _jsxFileName = \"S:\\\\REACT\\\\Ract-Js\\\\Frlnce\\\\src\\\\pages\\\\login\\\\Login.js\";\nimport React, { Component } from \"react\";\nimport Container from \"react-bootstrap/Container\";\nimport Button from \"react-bootstrap/Button\";\nimport \"./Login.css\";\nimport cw_logo from \"./images/cw_logo.png\";\nimport Form from \"react-bootstrap/Form\";\nimport Row from \"react-bootstrap/Row\";\nimport ApiService from \"../../_services/ApiService\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faArrowLeft } from '@fortawesome/free-solid-svg-icons';\nimport Config from \"../../_config/config\";\nimport OTPValidator from './../../_components/OTPValidator';\nimport { ILoader } from './../../_components/iloader/iloader';\nimport FacebookLoginComponent from './FacebookLoginComponent';\nimport jwt_decode from \"jwt-decode\";\n\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n\n    this.updateInput = e => {\n      let v = e.target.value;\n      let k = e.target.name;\n      let loginDetails = { ...this.state.loginDetails\n      };\n      loginDetails[k] = v;\n      this.setState({\n        loginDetails\n      });\n    };\n\n    this.onOTPValidatorClose = value => {\n      //console.log(\"Register --> onOTPValidatorClose...\"+value);\n      // store user details in local storage to keep user logged in between page refreshes    \n      if (value === true) {\n        var loginUserData = this.state.loginUserData;\n        var decoded = jwt_decode(loginUserData.token);\n        localStorage.setItem('user', JSON.stringify(this.state.loginUserData));\n        localStorage.setItem('tenant', decoded.tenant);\n        this.props.history.push('/');\n      } else {\n        let _otpValidator = {\n          show: false,\n          otp: null,\n          smsAddress: null,\n          message: 'Successfully sent the One Time Password to your Registered Mobile Number',\n          userId: null\n        };\n        this.setState({\n          otpValidator: _otpValidator\n        });\n      }\n    };\n\n    this.state = {\n      submitted: false,\n      user: null,\n      errorMessage: '',\n      loginDetails: {\n        username: '',\n        password: ''\n      },\n      otpValidator: {\n        show: false,\n        otpLength: 0,\n        smsAddress: null,\n        message: 'Successfully sent the One Time Password to your Registered Mobile Number',\n        userId: null\n      },\n      loginUserData: null,\n      showLoading: false,\n      loginPageConfig: this.props.location.state.loginPageConfig\n    }; //this.onSubmit = this.onSubmit.bind(this);\n    //this.init();\n  }\n\n  init() {\n    let loginUser = JSON.parse(localStorage.getItem('user'));\n\n    if (loginUser != null) {\n      localStorage.removeItem(\"user\");\n      this.props.history.push('/');\n    }\n  }\n\n  routeChange(path) {\n    this.props.history.push(path);\n  }\n\n  login() {\n    let {\n      loginDetails\n    } = this.state;\n\n    if (loginDetails.username && loginDetails.password) {\n      this.setState({\n        submitted: true,\n        showLoading: true\n      }, () => {\n        ApiService.fetchLogin(loginDetails.username, loginDetails.password).then(res => {\n          console.log(\"Login -> onSubmit(); res : \" + JSON.stringify(res));\n\n          if (res.data.status === 1) {\n            this.setState({\n              showLoading: false,\n              loginUserData: res.data.data\n            }, () => {\n              this.dologin();\n            });\n          } else {\n            this.setState({\n              showLoading: false,\n              errorMessage: res.data.message\n            });\n          }\n        });\n      });\n    }\n  }\n\n  dologin() {\n    //localStorage.getItem('user')\n    let loginUserData = this.state.loginUserData;\n    var decoded = jwt_decode(loginUserData.token);\n\n    if (loginUserData.otpEnableStatus && loginUserData.otpEnableStatus === 1) {\n      let _otpValidator = {\n        show: true,\n        otpLength: loginUserData.otpLength,\n        smsAddress: loginUserData.smsAddress,\n        message: loginUserData.otpMessage,\n        userId: loginUserData.userId\n      };\n      this.setState({\n        otpValidator: _otpValidator\n      });\n    } else {\n      localStorage.setItem('user', JSON.stringify(loginUserData));\n      localStorage.setItem('tenant', decoded.tenant);\n      this.props.history.push('/');\n    }\n  }\n\n  routeChange(path) {\n    this.props.history.push(path);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Container, {\n      fluid: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"back\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n      icon: faArrowLeft,\n      onClick: () => this.routeChange('/'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 19\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"header-image\",\n      style: {\n        background: `url(${Config.cover}) no-repeat transparent`,\n        backgroundSize: 'cover',\n        backgroundPosition: 'center'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"main-content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"gradient-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }\n    }, \" LOGIN \")), this.renderFormLogin())), this.renderFooter(), /*#__PURE__*/React.createElement(OTPValidator, {\n      data: this.state.otpValidator,\n      onOTPValidatorClose: this.onOTPValidatorClose,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }\n    }), this.renderLoader());\n  }\n\n  renderFormLogin() {\n    //console.log(this.props);\n    let {\n      submitted,\n      loginDetails\n    } = this.state;\n    return /*#__PURE__*/React.createElement(Form, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Form.Group, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: 'item-inner' + (submitted && !loginDetails.username ? ' has-error' : ''),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      class: \"form-control\",\n      type: \"text\",\n      placeholder: \"Username\",\n      name: \"username\",\n      onChange: this.updateInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: 'item-inner' + (submitted && !loginDetails.password ? ' has-error' : ''),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      class: \"form-control\",\n      type: \"password\",\n      placeholder: \"Password\",\n      name: \"password\",\n      onChange: this.updateInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"institute-sign-in-btn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      className: \"primary button-full ilearn-blue-btn button-md\",\n      type: \"button\",\n      value: \"Login\",\n      onClick: () => this.login(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 11\n      }\n    })), this.state.errorMessage && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"red\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 38\n      }\n    }, this.state.errorMessage), this.renderRegister()));\n  }\n\n  renderRegister() {\n    var _this$state$loginPage, _this$state$loginPage2;\n\n    const show_registration_btn = ((_this$state$loginPage = this.state.loginPageConfig) === null || _this$state$loginPage === void 0 ? void 0 : _this$state$loginPage.SHOW_REGISTER_BUTTON) === 'true' ? true : false;\n    const show_facebook_btn = ((_this$state$loginPage2 = this.state.loginPageConfig) === null || _this$state$loginPage2 === void 0 ? void 0 : _this$state$loginPage2.FACEBOOK_LOGIN) === 'true' ? true : false;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"forgetpwd_link\",\n      onClick: () => this.routeChange(\"forgetpwd\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 15\n      }\n    }, \" Forgot Password ? \"))), (show_registration_btn || show_facebook_btn) && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"or\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"strike\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 17\n      }\n    }, \" OR \"))), show_registration_btn && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"institute-sign-in-btn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"primary button-full ilearn-blue-btn button-md\",\n      onClick: () => this.routeChange(\"register\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"button-inner\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 19\n      }\n    }, \" Register \"))), show_facebook_btn && /*#__PURE__*/React.createElement(FacebookLoginComponent, Object.assign({}, this.props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 15\n      }\n    }))));\n  }\n\n  renderFooter() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"institute-cards\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"institute-top-intro\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"h6\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 13\n      }\n    }, \" Powered by \"), \" \", /*#__PURE__*/React.createElement(\"img\", {\n      src: cw_logo,\n      alt: \"logo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 35\n      }\n    }))));\n  }\n\n  renderLoader() {\n    console.log(\"Login -> renderLoader()... \");\n    const _loadingText = 'Please wait...';\n    return /*#__PURE__*/React.createElement(ILoader, {\n      loadingText: _loadingText,\n      isShow: this.state.showLoading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }\n    });\n  }\n\n}\n\nexport default Login;","map":{"version":3,"sources":["S:/REACT/Ract-Js/Frlnce/src/pages/login/Login.js"],"names":["React","Component","Container","Button","cw_logo","Form","Row","ApiService","FontAwesomeIcon","faArrowLeft","Config","OTPValidator","ILoader","FacebookLoginComponent","jwt_decode","Login","constructor","props","updateInput","e","v","target","value","k","name","loginDetails","state","setState","onOTPValidatorClose","loginUserData","decoded","token","localStorage","setItem","JSON","stringify","tenant","history","push","_otpValidator","show","otp","smsAddress","message","userId","otpValidator","submitted","user","errorMessage","username","password","otpLength","showLoading","loginPageConfig","location","init","loginUser","parse","getItem","removeItem","routeChange","path","login","fetchLogin","then","res","console","log","data","status","dologin","otpEnableStatus","otpMessage","render","background","cover","backgroundSize","backgroundPosition","renderFormLogin","renderFooter","renderLoader","renderRegister","show_registration_btn","SHOW_REGISTER_BUTTON","show_facebook_btn","FACEBOOK_LOGIN","_loadingText"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport Container from \"react-bootstrap/Container\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport \"./Login.css\";\r\nimport cw_logo from \"./images/cw_logo.png\";\r\nimport Form from \"react-bootstrap/Form\";\r\nimport Row from \"react-bootstrap/Row\";\r\nimport ApiService from \"../../_services/ApiService\";\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faArrowLeft} from '@fortawesome/free-solid-svg-icons';\r\nimport Config from \"../../_config/config\";\r\nimport OTPValidator from './../../_components/OTPValidator';\r\nimport {ILoader} from './../../_components/iloader/iloader';\r\nimport FacebookLoginComponent from './FacebookLoginComponent';\r\nimport jwt_decode from \"jwt-decode\";\r\n\r\nclass Login extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      submitted: false,\r\n      user: null,\r\n      errorMessage: '',\r\n      loginDetails:{\r\n        username: '',\r\n        password: ''\r\n      },\r\n      otpValidator: { show:false, \r\n        otpLength: 0, \r\n        smsAddress: null, \r\n        message:'Successfully sent the One Time Password to your Registered Mobile Number',\r\n        userId: null\r\n      },\r\n      loginUserData: null,\r\n      showLoading: false,\r\n      loginPageConfig : this.props.location.state.loginPageConfig\r\n    }\r\n     //this.onSubmit = this.onSubmit.bind(this);\r\n     //this.init();\r\n  }\r\n\r\n  init() {\r\n    let loginUser = JSON.parse(localStorage.getItem('user'));\r\n    if(loginUser != null) {\r\n      localStorage.removeItem(\"user\");\r\n      this.props.history.push('/');\r\n    }  \r\n  }\r\n\r\n  routeChange(path) {\r\n    this.props.history.push(path);\r\n  }\r\n\r\n  updateInput = (e) =>{\r\n    let v = e.target.value;\r\n    let k = e.target.name;\r\n    let loginDetails = {...this.state.loginDetails}\r\n    loginDetails[k] = v;\r\n    this.setState({loginDetails});\r\n  }\r\n\r\n  login() {\r\n    let { loginDetails} = this.state;\r\n    if (loginDetails.username && loginDetails.password) {\r\n      this.setState({ submitted: true, showLoading: true }, () => {\r\n        ApiService.fetchLogin(loginDetails.username, loginDetails.password)\r\n        .then((res) => {\r\n          console.log(\"Login -> onSubmit(); res : \"+JSON.stringify(res));\r\n          if(res.data.status===1) { \r\n            this.setState({ showLoading: false, loginUserData: res.data.data }, () => {\r\n              this.dologin();\r\n            }); \r\n          }\r\n          else {\r\n            this.setState({\r\n              showLoading: false,\r\n              errorMessage : res.data.message\r\n            });  \r\n          }\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  dologin() {\r\n    //localStorage.getItem('user')\r\n    let loginUserData = this.state.loginUserData;\r\n    var decoded = jwt_decode(loginUserData.token);\r\n    if(loginUserData.otpEnableStatus && loginUserData.otpEnableStatus===1) {\r\n      let _otpValidator = { show:true, \r\n        otpLength: loginUserData.otpLength, \r\n        smsAddress: loginUserData.smsAddress,\r\n        message: loginUserData.otpMessage,\r\n        userId: loginUserData.userId\r\n      }\r\n      this.setState({ otpValidator: _otpValidator });   \r\n    }\r\n    else {\r\n      localStorage.setItem('user', JSON.stringify(loginUserData));\r\n      localStorage.setItem('tenant', decoded.tenant);\r\n      this.props.history.push('/');\r\n    }\r\n  }\r\n\r\n  routeChange(path) {\r\n    this.props.history.push(path);\r\n  }\r\n\r\n  render() {\r\n    \r\n    return (\r\n      <div className=\"login\">\r\n        {\r\n          <Container fluid>\r\n            <div className=\"back\">\r\n                  <FontAwesomeIcon icon={ faArrowLeft } onClick={() => this.routeChange('/')} />\r\n            </div>\r\n            <div className=\"header-image\" style={{background: `url(${Config.cover}) no-repeat transparent`,  backgroundSize: 'cover', backgroundPosition: 'center'}}>\r\n\r\n            </div>\r\n            <div className=\"main-content\">\r\n              <span className=\"gradient-text\">\r\n                <strong> LOGIN </strong>\r\n              </span>\r\n              {this.renderFormLogin()}\r\n            </div>\r\n          </Container>\r\n        }\r\n        {this.renderFooter()}\r\n        <OTPValidator data={this.state.otpValidator} \r\n                onOTPValidatorClose={this.onOTPValidatorClose} />\r\n        {this.renderLoader()}\r\n      </div>\r\n\t  \r\n    );\r\n  }\r\n\r\n  renderFormLogin() {\r\n    //console.log(this.props);\r\n    let { submitted, loginDetails} = this.state;    \r\n    return (\r\n      <Form>\r\n        <br/>\r\n      <Form.Group>\r\n        <div className={'item-inner' + (submitted && !loginDetails.username ? ' has-error' : '')}>\r\n          <input class=\"form-control\" type=\"text\" placeholder=\"Username\" name=\"username\" onChange={this.updateInput} />\r\n        </div>\r\n        <br />\r\n        <div className={'item-inner' + (submitted && !loginDetails.password ? ' has-error' : '')}>\r\n          <input class=\"form-control\" type=\"password\" placeholder=\"Password\" name=\"password\" onChange={this.updateInput} />\r\n        </div>\r\n        <div className=\"institute-sign-in-btn\">\r\n          <input className=\"primary button-full ilearn-blue-btn button-md\" type=\"button\" value=\"Login\"  onClick={() => this.login()}/>\r\n        </div>\r\n        { this.state.errorMessage && <div className=\"red\">{this.state.errorMessage}</div> }\r\n        {this.renderRegister()}\r\n      </Form.Group>\r\n     </Form>\r\n    );\r\n  }\r\n\r\n  renderRegister() {\r\n    const show_registration_btn = this.state.loginPageConfig?.SHOW_REGISTER_BUTTON==='true'?true:false;\r\n    const show_facebook_btn = this.state.loginPageConfig?.FACEBOOK_LOGIN==='true'?true:false;    \r\n    return (\r\n      <div>        \r\n        <Row>\r\n            <div className=\"forgetpwd_link\" onClick={() => this.routeChange(\"forgetpwd\")}>\r\n              <b> Forgot Password ? </b>\r\n            </div>            \r\n        </Row>\r\n        {\r\n          (show_registration_btn ||  show_facebook_btn) && \r\n          <>\r\n            <div className=\"or\">\r\n              <div className=\"strike\">\r\n                <span> OR </span>\r\n              </div>\r\n            </div>\r\n            {\r\n              show_registration_btn && \r\n              <div className=\"institute-sign-in-btn\">\r\n                <Button variant=\"primary button-full ilearn-blue-btn button-md\" onClick={() => this.routeChange(\"register\")}>\r\n                  <span className=\"button-inner\"> Register </span>\r\n                </Button>\r\n              </div>\r\n            }\r\n            { \r\n              show_facebook_btn && \r\n              <FacebookLoginComponent {...this.props} />\r\n            }\r\n          </>\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onOTPValidatorClose = value => {\r\n    //console.log(\"Register --> onOTPValidatorClose...\"+value);\r\n    // store user details in local storage to keep user logged in between page refreshes    \r\n    if(value===true) {\r\n      var loginUserData = this.state.loginUserData;\r\n      var decoded = jwt_decode(loginUserData.token);\r\n      localStorage.setItem('user', JSON.stringify(this.state.loginUserData));\r\n      localStorage.setItem('tenant', decoded.tenant);\r\n      this.props.history.push('/');\r\n    }\r\n    else {\r\n      let _otpValidator= { show:false, \r\n        otp: null, \r\n        smsAddress: null, \r\n        message:'Successfully sent the One Time Password to your Registered Mobile Number',\r\n        userId: null\r\n      }\r\n      this.setState({ otpValidator: _otpValidator }); \r\n    }      \r\n  }  \r\n\r\n  renderFooter() {\r\n    return (\r\n      <div className=\"institute-cards\">\r\n        <div className=\"\">\r\n          <div className=\"institute-top-intro\">\r\n            <h6> Powered by </h6> <img src={cw_logo} alt=\"logo\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderLoader() {\r\n    console.log(\"Login -> renderLoader()... \");\r\n    const _loadingText = 'Please wait...';\r\n    return (\r\n        <ILoader\r\n            loadingText={_loadingText}\r\n            isShow={this.state.showLoading}\r\n            >\r\n        </ILoader>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}