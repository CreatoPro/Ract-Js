{"ast":null,"code":"var _jsxFileName = \"S:\\\\REACT\\\\Ract-Js\\\\Frlnce\\\\src\\\\pages\\\\learning\\\\LearningStepAttachmentDetails.js\";\nimport React, { Component } from \"react\";\nimport Container from \"react-bootstrap/Container\";\nimport \"./Learning.css\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faArrowLeft } from \"@fortawesome/free-solid-svg-icons\";\nimport ApiService from \"../../_services/ApiService\";\nimport Loader from \"./../../_components/loader/loader\";\nimport Model from \"./components/Model\";\nimport Resource from \"./components/Resource\";\nimport ico_notes from \"./images/ico_notes.svg\";\nimport ico_handouts from \"./images/ico_discussion.svg\";\nimport ico_interview from \"./images/ico_interview.svg\";\nimport CKEditor from \"ckeditor4-react\";\nimport XAPIUtils from \"../xapi/xapiutils\";\n\nclass LearningStepAttachmentDetails extends Component {\n  constructor(props) {\n    super(props);\n\n    this.modeShow = show => {\n      this.setState({\n        show: show\n      });\n    };\n\n    this.changeContent = (groupIndex, stepIndex, resourceIndex, lessonPlanId) => {\n      this.setState({\n        groupIndex: groupIndex,\n        stepIndex: stepIndex,\n        resourceIndex: resourceIndex\n      });\n\n      if (this.state.groups[groupIndex].steps[stepIndex].resources[resourceIndex].studyResourceType === \"0\") {\n        window.open('/TestInstructions/' + this.state.groups[groupIndex].steps[stepIndex].resources[resourceIndex].id + '?lms=' + lessonPlanId, \"Start Test\", 'height=' + window.screen.height + ',width=' + window.screen.width);\n      } else {\n        this.props.history.push({\n          pathname: `/lesson/steps/attachments/${this.state.groups[groupIndex].steps[stepIndex].id}/details/${this.state.groups[groupIndex].steps[stepIndex].resources[resourceIndex].id}`,\n          state: {\n            lessonPlanId: lessonPlanId,\n            groupIndex: groupIndex,\n            stepIndex: stepIndex,\n            resourceIndex: resourceIndex\n          }\n        });\n      }\n    };\n\n    this.loadNextResource = () => {\n      if (this.state.resourceIndex === this.state.groups[this.state.groupIndex].steps[this.state.stepIndex].resources.length - 1) {\n        if (this.state.stepIndex === this.state.groups[this.state.groupIndex].steps.length - 1) {\n          this.changeContent(this.state.groupIndex + 1, 0, 0, this.props.location.state.lessonPlanId);\n        } else {\n          this.changeContent(this.state.groupIndex, this.state.stepIndex + 1, 0, this.props.location.state.lessonPlanId);\n        }\n      } else {\n        this.changeContent(this.state.groupIndex, this.state.stepIndex, this.state.resourceIndex + 1, this.props.location.state.lessonPlanId);\n      }\n    };\n\n    this.loadPrevResource = () => {\n      if (this.state.resourceIndex === 0) {\n        if (this.state.stepIndex === 0) {\n          console.log(this.state.groups[this.state.groupIndex].steps.length);\n          let newStepIndex = this.state.groups[this.state.groupIndex - 1].steps.length - 1;\n          this.changeContent(this.state.groupIndex - 1, newStepIndex, this.state.groups[this.state.groupIndex - 1].steps[newStepIndex].resources.length - 1, this.props.location.state.lessonPlanId);\n        } else {\n          this.changeContent(this.state.groupIndex, this.state.stepIndex - 1, this.state.groups[this.state.groupIndex].steps[this.state.stepIndex - 1].resources.length - 1, this.props.location.state.lessonPlanId);\n        }\n      } else {\n        this.changeContent(this.state.groupIndex, this.state.stepIndex, this.state.resourceIndex - 1, this.props.location.state.lessonPlanId);\n      }\n    };\n\n    this.state = {\n      list: [],\n      message: null,\n      loading: false,\n      show: false,\n      close: false,\n      resourceIndex: 0,\n      resourceId: 0,\n      groupIndex: 0,\n      stepIndex: 0,\n      activeAttachemnt: null\n    };\n    this.reloadLearningStepAttachmentDetailsList = this.reloadLearningStepAttachmentDetailsList.bind(this);\n    this.trackStudyResourcesLearningActivity = this.trackStudyResourcesLearningActivity.bind(this);\n    this.reloadLearningStepsList = this.reloadLearningStepsList.bind(this); //this.reloadLearningList = this.reloadLearningList.bind(this);\n  }\n\n  componentDidMount() {\n    console.log(\"here\"); //console.log(this.props);\n\n    this.reloadLearningStepAttachmentDetailsList();\n    this.trackStudyResourcesLearningActivity();\n    this.reloadLearningStepsList(); //this.reloadLearningList();\n\n    this.scrollTop();\n  }\n\n  /*reloadLearningList() {\r\n    this.setState({ loading: true }, () => {\r\n      ApiService.fetchLearning(this.props.location.state.lessonPlanId,1)\r\n      .then((res) => {\r\n          this.setState({\r\n            loading: false,\r\n            groups: res.data\r\n          });\r\n      });\r\n    });\t\r\n  }*/\n  loadNext() {\n    var groupIndex = 1;\n    var groups = [];\n    var stepIndex = 1;\n    var resourceIndex = 1;\n\n    if (groupIndex >= groups.length) {\n      return this.endOfModules();\n    }\n\n    var group = groups[groupIndex];\n    var stepId = group[stepIndex].id;\n\n    if (group[stepIndex].resources.length > 0) {\n      var resourceId = group[stepIndex].resources[resourceIndex];\n\n      if (resourceId === undefined) {\n        //groupIndex++;\n        //stepIndex = 0;\n        stepIndex++;\n        resourceIndex = 0;\n\n        if (groupIndex >= groups.length) {\n          return this.endOfModules();\n        }\n\n        group = groups[groupIndex];\n\n        if (group[stepIndex] === undefined) {\n          groupIndex++;\n          stepIndex = 0;\n          group = groups[groupIndex];\n        }\n\n        if (group == undefined || group[stepIndex] === undefined) {\n          return this.endOfModules();\n        }\n\n        stepId = group[stepIndex].id;\n        resourceId = group[stepIndex].resources[resourceIndex];\n      } //call api\n\n\n      resourceIndex++;\n    } else {\n      alert(\"Oops! <br/>We could not find any Learning Material!\");\n    }\n  }\n\n  endOfModules() {\n    alert(\"Congratulations! <br/>You have reached the last step in the module!\");\n    return;\n  }\n\n  reloadLearningStepAttachmentDetailsList() {\n    this.setState({\n      loading: true\n    }, () => {\n      ApiService.fetchLearningStepAttachments(this.props.match.params.id).then(res => {\n        let attachments = res.data.attachments;\n\n        let _activeAttachment;\n\n        attachments.map((_studyResource, index) => {\n          if (_studyResource.id == this.props.match.params.resourceId) {\n            _activeAttachment = _studyResource;\n            this.setState({\n              loading: false,\n              list: res.data.attachments,\n              activeAttachment: _activeAttachment,\n              resourceId: this.props.match.params.resourceId,\n              groupIndex: this.props.location.state.groupIndex,\n              stepIndex: this.props.location.state.stepIndex,\n              resourceIndex: this.props.location.state.resourceIndex\n            });\n          }\n        });\n      }).catch(error => console.log(error));\n    });\n  }\n\n  reloadLearningStepsList() {\n    this.setState({\n      loading: true\n    }, () => {\n      ApiService.fetchLearningStepsDesktop(this.props.location.state.lessonPlanId).then(res => {\n        console.log(res.data.groups);\n        this.setState({\n          loading: false,\n          groups: res.data.groups\n        });\n      });\n    });\n  }\n\n  trackStudyResourcesLearningActivity() {\n    let data = {\n      groupIndex: this.props.location.state.groupIndex,\n      stepIndex: this.props.location.state.stepIndex,\n      resourceIndex: this.props.location.state.resourceIndex,\n      type: \"resource\",\n      id: this.props.match.params.resourceId\n    };\n    ApiService.trackStudyResourcesLearningActivity(this.props.location.state.lessonPlanId, data).then(res => {\n      console.log(res);\n    });\n  }\n\n  routeChange(path, resource) {\n    //alert(JSON.stringify(resource))\n    this.props.history.push({\n      pathname: path,\n      state: {\n        resource: resource,\n        stepId: this.props.match.params.id\n      }\n    });\n  }\n\n  scrollTop() {\n    document.body.scrollTop = 0;\n    document.documentElement.scrollTop = 0;\n  }\n\n  loadCurrentResource(index) {\n    this.scrollTop();\n\n    if (this.state.groupIndex >= this.state.groups.length) {\n      alert(\"Congratulations! You have reached the last step in the module!\");\n    } //alert(\"groupIndex:\"+this.state.groupIndex+\" stepIndex:\"+ this.state.stepIndex+ \" resourceIndex\"+index);\n\n\n    if (index >= 0 && this.state.list.length > index) {\n      this.setState({\n        resourceId: this.state.list[index].id,\n        resourceIndex: index\n      });\n    } else if (index > 0) {//alert(\"Congratulations! You have reached the last step in the module!\");\n      //this.props.history.goBack();\n    }\n  }\n\n  render() {\n    const {\n      loading\n    } = this.state;\n    localStorage.setItem(\"firstVisit\", false);\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Container, {\n      fluid: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 9\n      }\n    }, this.renderHeader(), loading ? /*#__PURE__*/React.createElement(Loader, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 22\n      }\n    }) : this.renderCard()), /*#__PURE__*/React.createElement(Model, {\n      show: this.state.show,\n      title: this.state.title,\n      type: this.state.type,\n      close: this.state.close,\n      modeShow: this.modeShow.bind(this),\n      resourceId: this.state.resourceId,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 9\n      }\n    })) // <div className=\"LearningAttachment\">\n    //   {\n    //     <Container fluid>\n    //         {loading ?  <Loader />: this.renderCard()}\n    //     </Container>\n    //   }\n    //   <Model\n    //       show={this.state.show}\n    //       title={this.state.title}\n    //       type= {this.state.type}\n    //       close={this.state.close}\n    //       modeShow={this.modeShow.bind(this)}\n    //       resourceId = {this.state.resourceId}\n    //   />\n    // </div>\n    ;\n  }\n\n  renderHeader() {\n    var _this$state$activeAtt;\n\n    console.log(\"LearningStepAttachmentDetails -> renderHeader()... \");\n    const CURRENT_PORTLET = JSON.parse(localStorage.getItem(\"portlet\"));\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: `ilearn-plain-header ${CURRENT_PORTLET.class}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"back\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n      icon: faArrowLeft,\n      onClick: this.props.history.goBack,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }\n    }, (_this$state$activeAtt = this.state.activeAttachment) === null || _this$state$activeAtt === void 0 ? void 0 : _this$state$activeAtt.name));\n  }\n\n  renderCard() {\n    let _studyResource = this.state.activeAttachment;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card_details\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 7\n      }\n    }, _studyResource && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Resource, {\n      data: _studyResource,\n      history: this.props.history,\n      stepId: this.props.match.params.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"divhide\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(CKEditor, {\n      name: \"message\",\n      placeholder: \"Compose message\",\n      data: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 15\n      }\n    })), this.renderFooter(_studyResource)));\n  }\n\n  renderFooter(item) {\n    var _this$state$groups;\n\n    const resourceIndex = this.state.resourceIndex;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mobile_bootom_navbar container-fluid\",\n      id: \"bootom_navbar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 373,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-2 col-sm-2 prev_div\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 13\n      }\n    }, this.state.groupIndex === 0 && this.state.stepIndex === 0 && this.state.resourceIndex === 0 ? null : /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-primary\",\n      onClick: this.loadPrevResource,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 16\n      }\n    }, \"Prev\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-2 col-sm-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      onClick: () => this.setState({\n        show: true,\n        title: \"Notes\",\n        type: \"note\"\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: ico_notes,\n      alt: \"Notes\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 388,\n        columnNumber: 17\n      }\n    }, \"Notes \"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-2 col-sm-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 391,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      onClick: () => this.routeChange(\"/discussion/resource/\" + item.id, item),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: ico_handouts,\n      alt: \"Discuss\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 17\n      }\n    }, \"Discuss\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-2 col-sm-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      onClick: () => this.setState({\n        show: true,\n        title: \"Doubts\",\n        type: \"doubt\"\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 402,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: ico_interview,\n      alt: \"Doubts\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 17\n      }\n    }, \"Doubts\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-2 col-sm-2 next_div\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 412,\n        columnNumber: 13\n      }\n    }, this.state.groupIndex === ((_this$state$groups = this.state.groups) === null || _this$state$groups === void 0 ? void 0 : _this$state$groups.length) - 1 && this.state.stepIndex === this.state.groups[this.state.groupIndex].steps.length - 1 && this.state.resourceIndex === this.state.groups[this.state.groupIndex].steps[this.state.stepIndex].resources.length - 1 ? null : /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-primary\",\n      onClick: this.loadNextResource,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 16\n      }\n    }, \"Next\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 13\n      }\n    }))));\n  }\n\n}\n\nexport default LearningStepAttachmentDetails;","map":{"version":3,"sources":["S:/REACT/Ract-Js/Frlnce/src/pages/learning/LearningStepAttachmentDetails.js"],"names":["React","Component","Container","FontAwesomeIcon","faArrowLeft","ApiService","Loader","Model","Resource","CKEditor","XAPIUtils","LearningStepAttachmentDetails","constructor","props","modeShow","show","setState","changeContent","groupIndex","stepIndex","resourceIndex","lessonPlanId","state","groups","steps","resources","studyResourceType","window","open","id","screen","height","width","history","push","pathname","loadNextResource","length","location","loadPrevResource","console","log","newStepIndex","list","message","loading","close","resourceId","activeAttachemnt","reloadLearningStepAttachmentDetailsList","bind","trackStudyResourcesLearningActivity","reloadLearningStepsList","componentDidMount","scrollTop","loadNext","endOfModules","group","stepId","undefined","alert","fetchLearningStepAttachments","match","params","then","res","attachments","data","_activeAttachment","map","_studyResource","index","activeAttachment","catch","error","fetchLearningStepsDesktop","type","routeChange","path","resource","document","body","documentElement","loadCurrentResource","render","localStorage","setItem","renderHeader","renderCard","title","CURRENT_PORTLET","JSON","parse","getItem","class","goBack","name","renderFooter","item","ico_notes","ico_handouts","ico_interview"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport Container from \"react-bootstrap/Container\";\r\nimport \"./Learning.css\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faArrowLeft } from \"@fortawesome/free-solid-svg-icons\";\r\nimport ApiService from \"../../_services/ApiService\";\r\nimport Loader from \"./../../_components/loader/loader\";\r\nimport Model from \"./components/Model\";\r\nimport Resource from \"./components/Resource\";\r\nimport ico_notes from \"./images/ico_notes.svg\";\r\nimport ico_handouts from \"./images/ico_discussion.svg\";\r\nimport ico_interview from \"./images/ico_interview.svg\";\r\nimport CKEditor from \"ckeditor4-react\";\r\nimport XAPIUtils from \"../xapi/xapiutils\";\r\n\r\nclass LearningStepAttachmentDetails extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      list: [],\r\n      message: null,\r\n      loading: false,\r\n      show: false,\r\n      close: false,\r\n      resourceIndex: 0,\r\n      resourceId: 0,\r\n      groupIndex: 0,\r\n      stepIndex: 0,\r\n      activeAttachemnt: null,\r\n    };\r\n    this.reloadLearningStepAttachmentDetailsList =\r\n      this.reloadLearningStepAttachmentDetailsList.bind(this);\r\n    this.trackStudyResourcesLearningActivity =\r\n      this.trackStudyResourcesLearningActivity.bind(this);\r\n    this.reloadLearningStepsList = this.reloadLearningStepsList.bind(this);\r\n    //this.reloadLearningList = this.reloadLearningList.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    console.log(\"here\");\r\n    //console.log(this.props);\r\n    this.reloadLearningStepAttachmentDetailsList();\r\n    this.trackStudyResourcesLearningActivity();\r\n    this.reloadLearningStepsList();\r\n    //this.reloadLearningList();\r\n    this.scrollTop();\r\n  }\r\n\r\n  modeShow = (show) => {\r\n    this.setState({\r\n      show: show,\r\n    });\r\n  };\r\n\r\n  /*reloadLearningList() {\r\n    this.setState({ loading: true }, () => {\r\n      ApiService.fetchLearning(this.props.location.state.lessonPlanId,1)\r\n      .then((res) => {\r\n          this.setState({\r\n            loading: false,\r\n            groups: res.data\r\n          });\r\n      });\r\n    });\t\r\n  }*/\r\n\r\n  loadNext() {\r\n    var groupIndex = 1;\r\n    var groups = [];\r\n    var stepIndex = 1;\r\n    var resourceIndex = 1;\r\n\r\n    if (groupIndex >= groups.length) {\r\n      return this.endOfModules();\r\n    }\r\n    var group = groups[groupIndex];\r\n    var stepId = group[stepIndex].id;\r\n    if (group[stepIndex].resources.length > 0) {\r\n      var resourceId = group[stepIndex].resources[resourceIndex];\r\n      if (resourceId === undefined) {\r\n        //groupIndex++;\r\n        //stepIndex = 0;\r\n        stepIndex++;\r\n        resourceIndex = 0;\r\n        if (groupIndex >= groups.length) {\r\n          return this.endOfModules();\r\n        }\r\n        group = groups[groupIndex];\r\n        if (group[stepIndex] === undefined) {\r\n          groupIndex++;\r\n          stepIndex = 0;\r\n          group = groups[groupIndex];\r\n        }\r\n        if (group == undefined || group[stepIndex] === undefined) {\r\n          return this.endOfModules();\r\n        }\r\n        stepId = group[stepIndex].id;\r\n        resourceId = group[stepIndex].resources[resourceIndex];\r\n      }\r\n\r\n      //call api\r\n      resourceIndex++;\r\n    } else {\r\n      alert(\"Oops! <br/>We could not find any Learning Material!\");\r\n    }\r\n  }\r\n\r\n  endOfModules() {\r\n    alert(\r\n      \"Congratulations! <br/>You have reached the last step in the module!\"\r\n    );\r\n    return;\r\n  }\r\n\r\n  reloadLearningStepAttachmentDetailsList() {\r\n    this.setState({ loading: true }, () => {\r\n      ApiService.fetchLearningStepAttachments(this.props.match.params.id)\r\n        .then((res) => {\r\n          let attachments = res.data.attachments;\r\n          let _activeAttachment;\r\n          attachments.map((_studyResource, index) => {\r\n            if (_studyResource.id == this.props.match.params.resourceId) {\r\n              _activeAttachment = _studyResource;\r\n              this.setState({\r\n                loading: false,\r\n                list: res.data.attachments,\r\n                activeAttachment: _activeAttachment,\r\n                resourceId: this.props.match.params.resourceId,\r\n                groupIndex: this.props.location.state.groupIndex,\r\n                stepIndex: this.props.location.state.stepIndex,\r\n                resourceIndex: this.props.location.state.resourceIndex,\r\n              });\r\n            }\r\n          });\r\n        })\r\n        .catch((error) => console.log(error));\r\n    });\r\n  }\r\n\r\n  reloadLearningStepsList() {\r\n    this.setState({ loading: true }, () => {\r\n      ApiService.fetchLearningStepsDesktop(\r\n        this.props.location.state.lessonPlanId\r\n      ).then((res) => {\r\n        console.log(res.data.groups);\r\n        this.setState({\r\n          loading: false,\r\n          groups: res.data.groups,\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  trackStudyResourcesLearningActivity() {\r\n    let data = {\r\n      groupIndex: this.props.location.state.groupIndex,\r\n      stepIndex: this.props.location.state.stepIndex,\r\n      resourceIndex: this.props.location.state.resourceIndex,\r\n      type: \"resource\",\r\n      id: this.props.match.params.resourceId,\r\n    };\r\n\r\n    ApiService.trackStudyResourcesLearningActivity(\r\n      this.props.location.state.lessonPlanId,\r\n      data\r\n    ).then((res) => {\r\n      console.log(res);\r\n    });\r\n  }\r\n\r\n  routeChange(path, resource) {\r\n    //alert(JSON.stringify(resource))\r\n    this.props.history.push({\r\n      pathname: path,\r\n      state: { resource: resource, stepId: this.props.match.params.id },\r\n    });\r\n  }\r\n\r\n  scrollTop() {\r\n    document.body.scrollTop = 0;\r\n    document.documentElement.scrollTop = 0;\r\n  }\r\n\r\n  loadCurrentResource(index) {\r\n    this.scrollTop();\r\n\r\n    if (this.state.groupIndex >= this.state.groups.length) {\r\n      alert(\"Congratulations! You have reached the last step in the module!\");\r\n    }\r\n    //alert(\"groupIndex:\"+this.state.groupIndex+\" stepIndex:\"+ this.state.stepIndex+ \" resourceIndex\"+index);\r\n    if (index >= 0 && this.state.list.length > index) {\r\n      this.setState({\r\n        resourceId: this.state.list[index].id,\r\n        resourceIndex: index,\r\n      });\r\n    } else if (index > 0) {\r\n      //alert(\"Congratulations! You have reached the last step in the module!\");\r\n      //this.props.history.goBack();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { loading } = this.state;\r\n    localStorage.setItem(\"firstVisit\", false);\r\n    return (\r\n      <>\r\n        <Container fluid>\r\n          {this.renderHeader()}\r\n          {loading ? <Loader /> : this.renderCard()}\r\n        </Container>\r\n        <Model\r\n          show={this.state.show}\r\n          title={this.state.title}\r\n          type={this.state.type}\r\n          close={this.state.close}\r\n          modeShow={this.modeShow.bind(this)}\r\n          resourceId={this.state.resourceId}\r\n        />\r\n      </>\r\n      // <div className=\"LearningAttachment\">\r\n      //   {\r\n      //     <Container fluid>\r\n      //         {loading ?  <Loader />: this.renderCard()}\r\n      //     </Container>\r\n      //   }\r\n      //   <Model\r\n      //       show={this.state.show}\r\n      //       title={this.state.title}\r\n      //       type= {this.state.type}\r\n      //       close={this.state.close}\r\n      //       modeShow={this.modeShow.bind(this)}\r\n      //       resourceId = {this.state.resourceId}\r\n      //   />\r\n      // </div>\r\n    );\r\n  }\r\n\r\n  renderHeader() {\r\n    console.log(\"LearningStepAttachmentDetails -> renderHeader()... \");\r\n    const CURRENT_PORTLET = JSON.parse(localStorage.getItem(\"portlet\"));\r\n    return (\r\n      <div className={`ilearn-plain-header ${CURRENT_PORTLET.class}`}>\r\n        <div className=\"back\">\r\n          <FontAwesomeIcon\r\n            icon={faArrowLeft}\r\n            onClick={this.props.history.goBack}\r\n          />\r\n        </div>\r\n        <h4>{this.state.activeAttachment?.name}</h4>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  changeContent = (groupIndex, stepIndex, resourceIndex, lessonPlanId) => {\r\n    this.setState({\r\n      groupIndex:groupIndex,\r\n      stepIndex: stepIndex,\r\n      resourceIndex:resourceIndex\r\n    })\r\n    if(this.state.groups[groupIndex].steps[stepIndex].resources[resourceIndex].studyResourceType===\"0\"){\r\n      window.open('/TestInstructions/'+this.state.groups[groupIndex].steps[stepIndex].resources[resourceIndex].id+'?lms='+lessonPlanId, \"Start Test\", 'height=' + window.screen.height + ',width=' + window.screen.width);\r\n    }else{\r\n\r\n      this.props.history.push({\r\n        pathname: `/lesson/steps/attachments/${this.state.groups[groupIndex].steps[stepIndex].id}/details/${this.state.groups[groupIndex].steps[stepIndex].resources[resourceIndex].id}`,\r\n        state: {\r\n          lessonPlanId: lessonPlanId,\r\n          groupIndex: groupIndex,\r\n          stepIndex: stepIndex,\r\n          resourceIndex: resourceIndex,\r\n        },\r\n      });\r\n    }\r\n  };\r\n\r\n  loadNextResource = () => {\r\n    if (\r\n      this.state.resourceIndex ===\r\n      this.state.groups[this.state.groupIndex].steps[this.state.stepIndex]\r\n        .resources.length -\r\n        1\r\n    ) {\r\n      if (\r\n        this.state.stepIndex ===\r\n        this.state.groups[this.state.groupIndex].steps.length - 1\r\n      ) {\r\n        this.changeContent(\r\n          this.state.groupIndex + 1,\r\n          0,\r\n          0,\r\n          this.props.location.state.lessonPlanId\r\n        );\r\n      } else {\r\n        this.changeContent(\r\n          this.state.groupIndex,\r\n          this.state.stepIndex + 1,\r\n          0,\r\n          this.props.location.state.lessonPlanId\r\n        );\r\n      }\r\n    } else {\r\n      this.changeContent(\r\n        this.state.groupIndex,\r\n        this.state.stepIndex,\r\n        this.state.resourceIndex + 1,\r\n        this.props.location.state.lessonPlanId\r\n      );\r\n    }\r\n  };\r\n\r\n  loadPrevResource = () => {\r\n    if (this.state.resourceIndex === 0) {\r\n      if (this.state.stepIndex === 0) {\r\n        console.log(this.state.groups[this.state.groupIndex].steps.length);\r\n        let newStepIndex = this.state.groups[this.state.groupIndex-1].steps.length - 1;\r\n        this.changeContent(\r\n          this.state.groupIndex-1,\r\n          newStepIndex,\r\n          this.state.groups[this.state.groupIndex - 1].steps[newStepIndex]\r\n            .resources.length - 1,\r\n          this.props.location.state.lessonPlanId\r\n        );\r\n      } else {\r\n        this.changeContent(\r\n          this.state.groupIndex,\r\n          this.state.stepIndex - 1,\r\n          this.state.groups[this.state.groupIndex].steps[\r\n            this.state.stepIndex - 1\r\n          ].resources.length - 1,\r\n          this.props.location.state.lessonPlanId\r\n        );\r\n      }\r\n    } else {\r\n      this.changeContent(\r\n        this.state.groupIndex,\r\n        this.state.stepIndex,\r\n        this.state.resourceIndex - 1,\r\n        this.props.location.state.lessonPlanId\r\n      );\r\n    }\r\n  };\r\n\r\n  renderCard() {\r\n    let _studyResource = this.state.activeAttachment;\r\n    return (\r\n      <div className=\"card_details\">\r\n        {_studyResource && (\r\n          <>\r\n            <Resource\r\n              data={_studyResource}\r\n              history={this.props.history}\r\n              stepId={this.props.match.params.id}\r\n            />\r\n            <div className=\"divhide\">\r\n              <CKEditor name=\"message\" placeholder=\"Compose message\" data=\"\" />\r\n            </div>\r\n            {this.renderFooter(_studyResource)}\r\n          </>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderFooter(item) {\r\n    const resourceIndex = this.state.resourceIndex;\r\n    return (\r\n      <>\r\n        <div\r\n          className=\"mobile_bootom_navbar container-fluid\"\r\n          id=\"bootom_navbar\"\r\n        >\r\n          <div className=\"row\">\r\n            <div className=\"col-1\"></div>\r\n            <div className=\"col-2 col-sm-2 prev_div\">\r\n            {\r\n              (this.state.groupIndex === 0 && this.state.stepIndex === 0 && this.state.resourceIndex ===0)?null\r\n              :<button className=\"btn btn-primary\" onClick={this.loadPrevResource}>Prev</button>\r\n            }\r\n              {/*<a onClick={() => this.loadCurrentResource(resourceIndex-1)} className=\"prev\">&laquo; Prev</a>*/}\r\n            </div>\r\n            <div className=\"col-2 col-sm-2\">\r\n              <a\r\n                onClick={() =>\r\n                  this.setState({ show: true, title: \"Notes\", type: \"note\" })\r\n                }\r\n              >\r\n                <img src={ico_notes} alt=\"Notes\" />\r\n                <span>Notes </span>\r\n              </a>\r\n            </div>\r\n            <div className=\"col-2 col-sm-2\">\r\n              <a\r\n                onClick={() =>\r\n                  this.routeChange(\"/discussion/resource/\" + item.id, item)\r\n                }\r\n              >\r\n                <img src={ico_handouts} alt=\"Discuss\" />\r\n                <span>Discuss</span>\r\n              </a>\r\n            </div>\r\n            <div className=\"col-2 col-sm-2\">\r\n              <a\r\n                onClick={() =>\r\n                  this.setState({ show: true, title: \"Doubts\", type: \"doubt\" })\r\n                }\r\n              >\r\n                <img src={ico_interview} alt=\"Doubts\" />\r\n                <span>Doubts</span>\r\n              </a>\r\n            </div>\r\n\r\n            <div className=\"col-2 col-sm-2 next_div\">\r\n            {\r\n              (this.state.groupIndex === this.state.groups?.length-1 && \r\n              this.state.stepIndex === this.state.groups[this.state.groupIndex].steps.length-1 && \r\n              this.state.resourceIndex === this.state.groups[this.state.groupIndex].steps[this.state.stepIndex].resources.length -1\r\n              )?null\r\n              :<button className=\"btn btn-primary\" onClick={this.loadNextResource}>Next</button>\r\n            }\r\n              {/*<a onClick={() => this.loadCurrentResource(resourceIndex+1)} className=\"next\">Next &raquo;</a>*/}\r\n            </div>\r\n            <div className=\"col-1\"></div>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default LearningStepAttachmentDetails;\r\n"]},"metadata":{},"sourceType":"module"}