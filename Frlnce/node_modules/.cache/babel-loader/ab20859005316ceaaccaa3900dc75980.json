{"ast":null,"code":"var _jsxFileName = \"S:\\\\REACT\\\\Ract-Js\\\\Frlnce\\\\src\\\\pages\\\\camera\\\\camera.component.jsx\";\nimport React from \"react\";\nimport \"./camera.styles.css\";\nimport { ReactComponent as CaptureIcon } from \"@svgr/webpack?-svgo,+titleProp,+ref!./images/circle-solid.svg\";\nimport { ReactComponent as CloseCameraIcon } from \"@svgr/webpack?-svgo,+titleProp,+ref!./images/video-slash-solid.svg\";\nimport { ReactComponent as OpenCameraIcon } from \"@svgr/webpack?-svgo,+titleProp,+ref!./images/video-solid.svg\";\nimport { ReactComponent as ChangeCameraIcon } from \"@svgr/webpack?-svgo,+titleProp,+ref!./images/rotate-solid.svg\";\nimport { ReactComponent as ShowImageIcon } from \"@svgr/webpack?-svgo,+titleProp,+ref!./images/images-solid.svg\";\nimport { ReactComponent as CheckIcon } from \"@svgr/webpack?-svgo,+titleProp,+ref!./images/check-solid.svg\";\nimport ImagePreview from \"../../_components/image-preview/image-preview.component\";\n\nclass Camera extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.changeCamera = () => {\n      if (this.cameraStream) {\n        let currentCameraValue = this.state.front;\n        this.setState({\n          front: !currentCameraValue\n        }, () => {\n          this.stopstream();\n          this.startstream();\n        });\n      }\n    };\n\n    this.startstream = () => {\n      var mediaSupport = (\"mediaDevices\" in navigator);\n\n      if (mediaSupport && null == this.cameraStream) {\n        navigator.mediaDevices.getUserMedia({\n          video: {\n            facingMode: this.state.front ? \"user\" : \"environment\"\n          }\n        }).then(mediaStream => {\n          this.cameraStream = mediaStream;\n          this.cameraRef.current.srcObject = mediaStream;\n          this.cameraRef.current.play();\n          this.setState({\n            cameraIsOn: true\n          });\n        }).catch(function (err) {\n          console.log(\"Unable to access camera: \" + err);\n        });\n      } else {\n        alert(\"Your browser does not support media devices.\");\n        return;\n      }\n    };\n\n    this.stopstream = () => {\n      if (null != this.cameraStream) {\n        this.setState({\n          cameraIsOn: false\n        });\n        this.cameraStream.getTracks().forEach(track => {\n          track.stop();\n        });\n        this.cameraStream = null;\n      }\n    };\n\n    this.capture = () => {\n      if (null != this.cameraStream) {\n        this.setState({\n          displayCaptureImage: true\n        }, () => {\n          var _this$cameraRef$curre, _this$canvas$current, _this$canvas$current2;\n\n          console.log((_this$cameraRef$curre = this.cameraRef.current) === null || _this$cameraRef$curre === void 0 ? void 0 : _this$cameraRef$curre.clientHeight);\n          this.canvas.current.width = this.cameraRef.current.clientWidth;\n          this.canvas.current.height = this.cameraRef.current.clientHeight;\n          let ctx = (_this$canvas$current = this.canvas.current) === null || _this$canvas$current === void 0 ? void 0 : _this$canvas$current.getContext(\"2d\");\n          ctx === null || ctx === void 0 ? void 0 : ctx.drawImage(this.cameraRef.current, 0, 0, this.canvas.current.clientWidth, this.canvas.current.clientHeight);\n          this.setState({\n            currentImage: (_this$canvas$current2 = this.canvas.current) === null || _this$canvas$current2 === void 0 ? void 0 : _this$canvas$current2.toDataURL(\"image/png\")\n          }, () => {\n            console.log(this.state.currentImage);\n            this.clearCanvas();\n          });\n        });\n      }\n    };\n\n    this.cancelImage = () => {\n      this.setState({\n        displayCaptureImage: false,\n        currentImage: null\n      });\n    };\n\n    this.selectImage = () => {\n      this.setState(preState => ({\n        capturedImages: [...preState.capturedImages, preState.currentImage]\n      }), () => {\n        this.setState({\n          displayCaptureImage: false,\n          currentImage: null\n        });\n      });\n    };\n\n    this.clearCanvas = () => {\n      var _this$canvas$current3;\n\n      this.canvas.current.style.display = \"block\";\n      let ctx = (_this$canvas$current3 = this.canvas.current) === null || _this$canvas$current3 === void 0 ? void 0 : _this$canvas$current3.getContext(\"2d\");\n      ctx === null || ctx === void 0 ? void 0 : ctx.clearRect(0, 0, this.canvas.current.clientWidth, this.canvas.current.clientHeight);\n      this.canvas.current.width = 0;\n      this.canvas.current.height = 0;\n    };\n\n    this.continueAttendance = () => {\n      console.log(this.props.location.state);\n      let prevStates = this.props.location.state.prevStates;\n      let pathParams = this.props.location.state.pathParams;\n      let photoString = \"\";\n      this.state.capturedImages.map((image, index) => photoString = photoString + `<p><img src=${image} alt=${index}/></p>`);\n\n      if (prevStates.message) {\n        prevStates.message = prevStates.message + photoString;\n        console.log(prevStates.message);\n      } else {\n        prevStates.message = photoString;\n        console.log(prevStates.message);\n      }\n\n      this.props.history.push({\n        pathname: `/discussionBoard/${pathParams.discussionBoardId}/topic/${pathParams.topicId}/comments`,\n        state: {\n          prevStates: prevStates\n        }\n      });\n    };\n\n    this.deleteCapturedImage = id => {\n      let holdingArray = this.state.capturedImages;\n      holdingArray.splice(id, 1);\n      this.setState({\n        capturedImages: [...holdingArray]\n      });\n    };\n\n    this.openImagePreview = () => {\n      this.setState({\n        displayImagePreview: true\n      });\n    };\n\n    this.closeImagePreview = () => {\n      this.setState({\n        displayImagePreview: false\n      });\n    };\n\n    this.state = {\n      front: false,\n      cameraIsOn: false,\n      currentImage: null,\n      capturedImages: [],\n      displayCaptureImage: false,\n      displayImagePreview: false\n    };\n    this.cameraRef = /*#__PURE__*/React.createRef();\n    this.cameraStream = null;\n    this.canvas = /*#__PURE__*/React.createRef();\n    console.log(this.props.location.state);\n  }\n\n  componentDidMount() {\n    this.clearCanvas();\n    this.startstream();\n  }\n\n  componentWillUnmount() {\n    this.stopstream();\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"play-area\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"play-area-sub\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: \"loading-camera\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 11\n      }\n    }, \"loading camera....\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"nav-bar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(CheckIcon, {\n      className: \"nav-bar-icon\",\n      onClick: this.continueAttendance,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(ShowImageIcon, {\n      className: \"nav-bar-icon\",\n      onClick: this.openImagePreview,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"image-capture-detail\",\n      onClick: this.openImagePreview,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 17\n      }\n    }, this.state.capturedImages.length)))), /*#__PURE__*/React.createElement(\"video\", {\n      ref: this.cameraRef,\n      id: \"stream\",\n      autoPlay: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"button-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 11\n      }\n    }, this.state.cameraIsOn ? /*#__PURE__*/React.createElement(CloseCameraIcon, {\n      className: \"camera-icon small-camera-icon\",\n      onClick: this.stopstream,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 15\n      }\n    }) : /*#__PURE__*/React.createElement(OpenCameraIcon, {\n      className: \"camera-icon small-camera-icon\",\n      onClick: this.startstream,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(CaptureIcon, {\n      className: \"camera-icon\",\n      onClick: this.capture,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(ChangeCameraIcon, {\n      className: \"camera-icon small-camera-icon\",\n      onClick: this.changeCamera,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 13\n      }\n    }))), /*#__PURE__*/React.createElement(\"canvas\", {\n      ref: this.canvas,\n      id: \"capture\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }\n    }), this.state.displayCaptureImage ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"capture-area\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"display-image\",\n      src: this.state.currentImage,\n      alt: \"imagecaptured\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"popup-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 13\n      }\n    }, \"Do You want to save this Picture?\"), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-success m-2\",\n      onClick: this.selectImage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 15\n      }\n    }, \"yes\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-danger m-2\",\n      onClick: this.cancelImage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 15\n      }\n    }, \"no\"))) : null, this.state.displayImagePreview ? /*#__PURE__*/React.createElement(ImagePreview, {\n      deleteCapturedImage: this.deleteCapturedImage,\n      capturedImages: this.state.capturedImages,\n      closeImagePreview: this.closeImagePreview,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 11\n      }\n    }) : null);\n  }\n\n}\n\nexport default Camera;","map":{"version":3,"sources":["S:/REACT/Ract-Js/Frlnce/src/pages/camera/camera.component.jsx"],"names":["React","ImagePreview","Camera","Component","constructor","props","changeCamera","cameraStream","currentCameraValue","state","front","setState","stopstream","startstream","mediaSupport","navigator","mediaDevices","getUserMedia","video","facingMode","then","mediaStream","cameraRef","current","srcObject","play","cameraIsOn","catch","err","console","log","alert","getTracks","forEach","track","stop","capture","displayCaptureImage","clientHeight","canvas","width","clientWidth","height","ctx","getContext","drawImage","currentImage","toDataURL","clearCanvas","cancelImage","selectImage","preState","capturedImages","style","display","clearRect","continueAttendance","location","prevStates","pathParams","photoString","map","image","index","message","history","push","pathname","discussionBoardId","topicId","deleteCapturedImage","id","holdingArray","splice","openImagePreview","displayImagePreview","closeImagePreview","createRef","componentDidMount","componentWillUnmount","render","length"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAO,qBAAP;;;;;;;AAOA,OAAOC,YAAP,MAAyB,yDAAzB;;AAEA,MAAMC,MAAN,SAAqBF,KAAK,CAACG,SAA3B,CAAqC;AACnCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAuBnBC,YAvBmB,GAuBJ,MAAM;AACnB,UAAI,KAAKC,YAAT,EAAuB;AACrB,YAAIC,kBAAkB,GAAG,KAAKC,KAAL,CAAWC,KAApC;AACA,aAAKC,QAAL,CAAc;AAAED,UAAAA,KAAK,EAAE,CAACF;AAAV,SAAd,EAA8C,MAAM;AAClD,eAAKI,UAAL;AACA,eAAKC,WAAL;AACD,SAHD;AAID;AACF,KA/BkB;;AAAA,SAiCnBA,WAjCmB,GAiCL,MAAM;AAClB,UAAIC,YAAY,IAAG,kBAAkBC,SAArB,CAAhB;;AACA,UAAID,YAAY,IAAI,QAAQ,KAAKP,YAAjC,EAA+C;AAC7CQ,QAAAA,SAAS,CAACC,YAAV,CACGC,YADH,CACgB;AACZC,UAAAA,KAAK,EAAE;AAAEC,YAAAA,UAAU,EAAE,KAAKV,KAAL,CAAWC,KAAX,GAAmB,MAAnB,GAA4B;AAA1C;AADK,SADhB,EAIGU,IAJH,CAISC,WAAD,IAAiB;AACrB,eAAKd,YAAL,GAAoBc,WAApB;AACA,eAAKC,SAAL,CAAeC,OAAf,CAAuBC,SAAvB,GAAmCH,WAAnC;AACA,eAAKC,SAAL,CAAeC,OAAf,CAAuBE,IAAvB;AACA,eAAKd,QAAL,CAAc;AAAEe,YAAAA,UAAU,EAAE;AAAd,WAAd;AACD,SATH,EAUGC,KAVH,CAUS,UAAUC,GAAV,EAAe;AACpBC,UAAAA,OAAO,CAACC,GAAR,CAAY,8BAA8BF,GAA1C;AACD,SAZH;AAaD,OAdD,MAcO;AACLG,QAAAA,KAAK,CAAC,8CAAD,CAAL;AACA;AACD;AACF,KArDkB;;AAAA,SAuDnBnB,UAvDmB,GAuDN,MAAM;AACjB,UAAI,QAAQ,KAAKL,YAAjB,EAA+B;AAC7B,aAAKI,QAAL,CAAc;AAAEe,UAAAA,UAAU,EAAE;AAAd,SAAd;AAEA,aAAKnB,YAAL,CAAkByB,SAAlB,GAA8BC,OAA9B,CAAuCC,KAAD,IAAW;AAC/CA,UAAAA,KAAK,CAACC,IAAN;AACD,SAFD;AAGA,aAAK5B,YAAL,GAAoB,IAApB;AACD;AACF,KAhEkB;;AAAA,SAkEnB6B,OAlEmB,GAkET,MAAM;AACd,UAAI,QAAQ,KAAK7B,YAAjB,EAA+B;AAC7B,aAAKI,QAAL,CAAc;AAAE0B,UAAAA,mBAAmB,EAAE;AAAvB,SAAd,EAA6C,MAAM;AAAA;;AACjDR,UAAAA,OAAO,CAACC,GAAR,0BAAY,KAAKR,SAAL,CAAeC,OAA3B,0DAAY,sBAAwBe,YAApC;AAEA,eAAKC,MAAL,CAAYhB,OAAZ,CAAoBiB,KAApB,GAA4B,KAAKlB,SAAL,CAAeC,OAAf,CAAuBkB,WAAnD;AACA,eAAKF,MAAL,CAAYhB,OAAZ,CAAoBmB,MAApB,GAA6B,KAAKpB,SAAL,CAAeC,OAAf,CAAuBe,YAApD;AACA,cAAIK,GAAG,2BAAG,KAAKJ,MAAL,CAAYhB,OAAf,yDAAG,qBAAqBqB,UAArB,CAAgC,IAAhC,CAAV;AACAD,UAAAA,GAAG,SAAH,IAAAA,GAAG,WAAH,YAAAA,GAAG,CAAEE,SAAL,CACE,KAAKvB,SAAL,CAAeC,OADjB,EAEE,CAFF,EAGE,CAHF,EAIE,KAAKgB,MAAL,CAAYhB,OAAZ,CAAoBkB,WAJtB,EAKE,KAAKF,MAAL,CAAYhB,OAAZ,CAAoBe,YALtB;AAOA,eAAK3B,QAAL,CACE;AAAEmC,YAAAA,YAAY,2BAAE,KAAKP,MAAL,CAAYhB,OAAd,0DAAE,sBAAqBwB,SAArB,CAA+B,WAA/B;AAAhB,WADF,EAEE,MAAM;AACJlB,YAAAA,OAAO,CAACC,GAAR,CAAY,KAAKrB,KAAL,CAAWqC,YAAvB;AACA,iBAAKE,WAAL;AACD,WALH;AAOD,SApBD;AAqBD;AACF,KA1FkB;;AAAA,SA4FnBC,WA5FmB,GA4FL,MAAM;AAClB,WAAKtC,QAAL,CAAc;AAAE0B,QAAAA,mBAAmB,EAAE,KAAvB;AAA8BS,QAAAA,YAAY,EAAE;AAA5C,OAAd;AACD,KA9FkB;;AAAA,SAgGnBI,WAhGmB,GAgGL,MAAM;AAClB,WAAKvC,QAAL,CACGwC,QAAD,KAAe;AACbC,QAAAA,cAAc,EAAE,CAAC,GAAGD,QAAQ,CAACC,cAAb,EAA6BD,QAAQ,CAACL,YAAtC;AADH,OAAf,CADF,EAIE,MAAM;AACJ,aAAKnC,QAAL,CAAc;AAAE0B,UAAAA,mBAAmB,EAAE,KAAvB;AAA8BS,UAAAA,YAAY,EAAE;AAA5C,SAAd;AACD,OANH;AAQD,KAzGkB;;AAAA,SA2GnBE,WA3GmB,GA2GL,MAAM;AAAA;;AAClB,WAAKT,MAAL,CAAYhB,OAAZ,CAAoB8B,KAApB,CAA0BC,OAA1B,GAAoC,OAApC;AACA,UAAIX,GAAG,4BAAG,KAAKJ,MAAL,CAAYhB,OAAf,0DAAG,sBAAqBqB,UAArB,CAAgC,IAAhC,CAAV;AACAD,MAAAA,GAAG,SAAH,IAAAA,GAAG,WAAH,YAAAA,GAAG,CAAEY,SAAL,CACE,CADF,EAEE,CAFF,EAGE,KAAKhB,MAAL,CAAYhB,OAAZ,CAAoBkB,WAHtB,EAIE,KAAKF,MAAL,CAAYhB,OAAZ,CAAoBe,YAJtB;AAMA,WAAKC,MAAL,CAAYhB,OAAZ,CAAoBiB,KAApB,GAA4B,CAA5B;AACA,WAAKD,MAAL,CAAYhB,OAAZ,CAAoBmB,MAApB,GAA6B,CAA7B;AACD,KAtHkB;;AAAA,SAwHnBc,kBAxHmB,GAwHE,MAAM;AACzB3B,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKzB,KAAL,CAAWoD,QAAX,CAAoBhD,KAAhC;AACA,UAAIiD,UAAU,GAAG,KAAKrD,KAAL,CAAWoD,QAAX,CAAoBhD,KAApB,CAA0BiD,UAA3C;AACA,UAAIC,UAAU,GAAG,KAAKtD,KAAL,CAAWoD,QAAX,CAAoBhD,KAApB,CAA0BkD,UAA3C;AACA,UAAIC,WAAW,GAAG,EAAlB;AACA,WAAKnD,KAAL,CAAW2C,cAAX,CAA0BS,GAA1B,CACE,CAACC,KAAD,EAAQC,KAAR,KACGH,WAAW,GAAGA,WAAW,GAAI,eAAcE,KAAM,QAAOC,KAAM,QAFnE;;AAKA,UAAIL,UAAU,CAACM,OAAf,EAAwB;AACtBN,QAAAA,UAAU,CAACM,OAAX,GAAqBN,UAAU,CAACM,OAAX,GAAqBJ,WAA1C;AACA/B,QAAAA,OAAO,CAACC,GAAR,CAAY4B,UAAU,CAACM,OAAvB;AACD,OAHD,MAGO;AACLN,QAAAA,UAAU,CAACM,OAAX,GAAqBJ,WAArB;AACA/B,QAAAA,OAAO,CAACC,GAAR,CAAY4B,UAAU,CAACM,OAAvB;AACD;;AAED,WAAK3D,KAAL,CAAW4D,OAAX,CAAmBC,IAAnB,CAAwB;AACtBC,QAAAA,QAAQ,EAAG,oBAAmBR,UAAU,CAACS,iBAAkB,UAAST,UAAU,CAACU,OAAQ,WADjE;AAEtB5D,QAAAA,KAAK,EAAE;AAAEiD,UAAAA,UAAU,EAAEA;AAAd;AAFe,OAAxB;AAID,KA9IkB;;AAAA,SAgJnBY,mBAhJmB,GAgJIC,EAAD,IAAQ;AAC5B,UAAIC,YAAY,GAAG,KAAK/D,KAAL,CAAW2C,cAA9B;AACAoB,MAAAA,YAAY,CAACC,MAAb,CAAoBF,EAApB,EAAwB,CAAxB;AACA,WAAK5D,QAAL,CAAc;AAAEyC,QAAAA,cAAc,EAAE,CAAC,GAAGoB,YAAJ;AAAlB,OAAd;AACD,KApJkB;;AAAA,SAsJnBE,gBAtJmB,GAsJA,MAAM;AACvB,WAAK/D,QAAL,CAAc;AAAEgE,QAAAA,mBAAmB,EAAE;AAAvB,OAAd;AACD,KAxJkB;;AAAA,SA0JnBC,iBA1JmB,GA0JC,MAAM;AACxB,WAAKjE,QAAL,CAAc;AAAEgE,QAAAA,mBAAmB,EAAE;AAAvB,OAAd;AACD,KA5JkB;;AAEjB,SAAKlE,KAAL,GAAa;AACXC,MAAAA,KAAK,EAAE,KADI;AAEXgB,MAAAA,UAAU,EAAE,KAFD;AAGXoB,MAAAA,YAAY,EAAE,IAHH;AAIXM,MAAAA,cAAc,EAAE,EAJL;AAKXf,MAAAA,mBAAmB,EAAE,KALV;AAMXsC,MAAAA,mBAAmB,EAAE;AANV,KAAb;AAQA,SAAKrD,SAAL,gBAAiBtB,KAAK,CAAC6E,SAAN,EAAjB;AACA,SAAKtE,YAAL,GAAoB,IAApB;AACA,SAAKgC,MAAL,gBAAcvC,KAAK,CAAC6E,SAAN,EAAd;AACAhD,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAKzB,KAAL,CAAWoD,QAAX,CAAoBhD,KAAhC;AACD;;AACDqE,EAAAA,iBAAiB,GAAG;AAClB,SAAK9B,WAAL;AACA,SAAKnC,WAAL;AACD;;AAEDkE,EAAAA,oBAAoB,GAAG;AACrB,SAAKnE,UAAL;AACD;;AAwIDoE,EAAAA,MAAM,GAAG;AACP,wBACE;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAG,MAAA,SAAS,EAAC,gBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BADF,eAEE;AAAK,MAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,SAAD;AACE,MAAA,SAAS,EAAC,cADZ;AAEE,MAAA,OAAO,EAAE,KAAKxB,kBAFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,aAAD;AACE,MAAA,SAAS,EAAC,cADZ;AAEE,MAAA,OAAO,EAAE,KAAKkB,gBAFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAKE;AACE,MAAA,SAAS,EAAC,sBADZ;AAEE,MAAA,OAAO,EAAE,KAAKA,gBAFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAI,KAAKjE,KAAL,CAAW2C,cAAX,CAA0B6B,MAA9B,CAJF,CALF,CALF,CAFF,eAoBE;AAAO,MAAA,GAAG,EAAE,KAAK3D,SAAjB;AAA4B,MAAA,EAAE,EAAC,QAA/B;AAAwC,MAAA,QAAQ,MAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MApBF,eAqBE;AAAK,MAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAKb,KAAL,CAAWiB,UAAX,gBACC,oBAAC,eAAD;AACE,MAAA,SAAS,EAAC,+BADZ;AAEE,MAAA,OAAO,EAAE,KAAKd,UAFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,gBAMC,oBAAC,cAAD;AACE,MAAA,SAAS,EAAC,+BADZ;AAEE,MAAA,OAAO,EAAE,KAAKC,WAFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPJ,eAYE,oBAAC,WAAD;AAAa,MAAA,SAAS,EAAC,aAAvB;AAAqC,MAAA,OAAO,EAAE,KAAKuB,OAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAZF,eAaE,oBAAC,gBAAD;AACE,MAAA,SAAS,EAAC,+BADZ;AAEE,MAAA,OAAO,EAAE,KAAK9B,YAFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAbF,CArBF,CADF,eAyCE;AAAQ,MAAA,GAAG,EAAE,KAAKiC,MAAlB;AAA0B,MAAA,EAAE,EAAC,SAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAzCF,EA0CG,KAAK9B,KAAL,CAAW4B,mBAAX,gBACC;AAAK,MAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AACE,MAAA,SAAS,EAAC,eADZ;AAEE,MAAA,GAAG,EAAE,KAAK5B,KAAL,CAAWqC,YAFlB;AAGE,MAAA,GAAG,EAAC,eAHN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAME;AAAG,MAAA,SAAS,EAAC,YAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CANF,eAOE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AACE,MAAA,SAAS,EAAC,qBADZ;AAEE,MAAA,OAAO,EAAE,KAAKI,WAFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,eAOE;AAAQ,MAAA,SAAS,EAAC,oBAAlB;AAAuC,MAAA,OAAO,EAAE,KAAKD,WAArD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAPF,CAPF,CADD,GAoBG,IA9DN,EA+DG,KAAKxC,KAAL,CAAWkE,mBAAX,gBACC,oBAAC,YAAD;AACE,MAAA,mBAAmB,EAAE,KAAKL,mBAD5B;AAEE,MAAA,cAAc,EAAE,KAAK7D,KAAL,CAAW2C,cAF7B;AAGE,MAAA,iBAAiB,EAAE,KAAKwB,iBAH1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,GAMG,IArEN,CADF;AAyED;;AAzOkC;;AA4OrC,eAAe1E,MAAf","sourcesContent":["import React from \"react\";\r\nimport \"./camera.styles.css\";\r\nimport { ReactComponent as CaptureIcon } from \"./images/circle-solid.svg\";\r\nimport { ReactComponent as CloseCameraIcon } from \"./images/video-slash-solid.svg\";\r\nimport { ReactComponent as OpenCameraIcon } from \"./images/video-solid.svg\";\r\nimport { ReactComponent as ChangeCameraIcon } from \"./images/rotate-solid.svg\";\r\nimport { ReactComponent as ShowImageIcon } from \"./images/images-solid.svg\";\r\nimport { ReactComponent as CheckIcon } from \"./images/check-solid.svg\";\r\nimport ImagePreview from \"../../_components/image-preview/image-preview.component\";\r\n\r\nclass Camera extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      front: false,\r\n      cameraIsOn: false,\r\n      currentImage: null,\r\n      capturedImages: [],\r\n      displayCaptureImage: false,\r\n      displayImagePreview: false,\r\n    };\r\n    this.cameraRef = React.createRef();\r\n    this.cameraStream = null;\r\n    this.canvas = React.createRef();\r\n    console.log(this.props.location.state);\r\n  }\r\n  componentDidMount() {\r\n    this.clearCanvas();\r\n    this.startstream();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.stopstream();\r\n  }\r\n  changeCamera = () => {\r\n    if (this.cameraStream) {\r\n      let currentCameraValue = this.state.front;\r\n      this.setState({ front: !currentCameraValue }, () => {\r\n        this.stopstream();\r\n        this.startstream();\r\n      });\r\n    }\r\n  };\r\n\r\n  startstream = () => {\r\n    var mediaSupport = \"mediaDevices\" in navigator;\r\n    if (mediaSupport && null == this.cameraStream) {\r\n      navigator.mediaDevices\r\n        .getUserMedia({\r\n          video: { facingMode: this.state.front ? \"user\" : \"environment\" },\r\n        })\r\n        .then((mediaStream) => {\r\n          this.cameraStream = mediaStream;\r\n          this.cameraRef.current.srcObject = mediaStream;\r\n          this.cameraRef.current.play();\r\n          this.setState({ cameraIsOn: true });\r\n        })\r\n        .catch(function (err) {\r\n          console.log(\"Unable to access camera: \" + err);\r\n        });\r\n    } else {\r\n      alert(\"Your browser does not support media devices.\");\r\n      return;\r\n    }\r\n  };\r\n\r\n  stopstream = () => {\r\n    if (null != this.cameraStream) {\r\n      this.setState({ cameraIsOn: false });\r\n\r\n      this.cameraStream.getTracks().forEach((track) => {\r\n        track.stop();\r\n      });\r\n      this.cameraStream = null;\r\n    }\r\n  };\r\n\r\n  capture = () => {\r\n    if (null != this.cameraStream) {\r\n      this.setState({ displayCaptureImage: true }, () => {\r\n        console.log(this.cameraRef.current?.clientHeight);\r\n\r\n        this.canvas.current.width = this.cameraRef.current.clientWidth;\r\n        this.canvas.current.height = this.cameraRef.current.clientHeight;\r\n        let ctx = this.canvas.current?.getContext(\"2d\");\r\n        ctx?.drawImage(\r\n          this.cameraRef.current,\r\n          0,\r\n          0,\r\n          this.canvas.current.clientWidth,\r\n          this.canvas.current.clientHeight\r\n        );\r\n        this.setState(\r\n          { currentImage: this.canvas.current?.toDataURL(\"image/png\") },\r\n          () => {\r\n            console.log(this.state.currentImage);\r\n            this.clearCanvas();\r\n          }\r\n        );\r\n      });\r\n    }\r\n  };\r\n\r\n  cancelImage = () => {\r\n    this.setState({ displayCaptureImage: false, currentImage: null });\r\n  };\r\n\r\n  selectImage = () => {\r\n    this.setState(\r\n      (preState) => ({\r\n        capturedImages: [...preState.capturedImages, preState.currentImage],\r\n      }),\r\n      () => {\r\n        this.setState({ displayCaptureImage: false, currentImage: null });\r\n      }\r\n    );\r\n  };\r\n\r\n  clearCanvas = () => {\r\n    this.canvas.current.style.display = \"block\";\r\n    let ctx = this.canvas.current?.getContext(\"2d\");\r\n    ctx?.clearRect(\r\n      0,\r\n      0,\r\n      this.canvas.current.clientWidth,\r\n      this.canvas.current.clientHeight\r\n    );\r\n    this.canvas.current.width = 0;\r\n    this.canvas.current.height = 0;\r\n  };\r\n\r\n  continueAttendance = () => {\r\n    console.log(this.props.location.state);\r\n    let prevStates = this.props.location.state.prevStates;\r\n    let pathParams = this.props.location.state.pathParams;\r\n    let photoString = \"\";\r\n    this.state.capturedImages.map(\r\n      (image, index) =>\r\n        (photoString = photoString + `<p><img src=${image} alt=${index}/></p>`)\r\n    );\r\n\r\n    if (prevStates.message) {\r\n      prevStates.message = prevStates.message + photoString;\r\n      console.log(prevStates.message);\r\n    } else {\r\n      prevStates.message = photoString;\r\n      console.log(prevStates.message);\r\n    }\r\n\r\n    this.props.history.push({\r\n      pathname: `/discussionBoard/${pathParams.discussionBoardId}/topic/${pathParams.topicId}/comments`,\r\n      state: { prevStates: prevStates },\r\n    });\r\n  };\r\n\r\n  deleteCapturedImage = (id) => {\r\n    let holdingArray = this.state.capturedImages;\r\n    holdingArray.splice(id, 1);\r\n    this.setState({ capturedImages: [...holdingArray] });\r\n  };\r\n\r\n  openImagePreview = () => {\r\n    this.setState({ displayImagePreview: true });\r\n  };\r\n\r\n  closeImagePreview = () => {\r\n    this.setState({ displayImagePreview: false });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"play-area\">\r\n        <div className=\"play-area-sub\">\r\n          <p className=\"loading-camera\">loading camera....</p>\r\n          <div className=\"nav-bar\">\r\n            <CheckIcon\r\n              className=\"nav-bar-icon\"\r\n              onClick={this.continueAttendance}\r\n            />\r\n            <div>\r\n              <ShowImageIcon\r\n                className=\"nav-bar-icon\"\r\n                onClick={this.openImagePreview}\r\n              />\r\n              <div\r\n                className=\"image-capture-detail\"\r\n                onClick={this.openImagePreview}\r\n              >\r\n                <p>{this.state.capturedImages.length}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <video ref={this.cameraRef} id=\"stream\" autoPlay></video>\r\n          <div className=\"button-group\">\r\n            {this.state.cameraIsOn ? (\r\n              <CloseCameraIcon\r\n                className=\"camera-icon small-camera-icon\"\r\n                onClick={this.stopstream}\r\n              />\r\n            ) : (\r\n              <OpenCameraIcon\r\n                className=\"camera-icon small-camera-icon\"\r\n                onClick={this.startstream}\r\n              />\r\n            )}\r\n            <CaptureIcon className=\"camera-icon\" onClick={this.capture} />\r\n            <ChangeCameraIcon\r\n              className=\"camera-icon small-camera-icon\"\r\n              onClick={this.changeCamera}\r\n            />\r\n          </div>\r\n        </div>\r\n        <canvas ref={this.canvas} id=\"capture\"></canvas>\r\n        {this.state.displayCaptureImage ? (\r\n          <div className=\"capture-area\">\r\n            <img\r\n              className=\"display-image\"\r\n              src={this.state.currentImage}\r\n              alt=\"imagecaptured\"\r\n            />\r\n            <p className=\"popup-text\">Do You want to save this Picture?</p>\r\n            <div>\r\n              <button\r\n                className=\"btn btn-success m-2\"\r\n                onClick={this.selectImage}\r\n              >\r\n                yes\r\n              </button>\r\n              <button className=\"btn btn-danger m-2\" onClick={this.cancelImage}>\r\n                no\r\n              </button>\r\n            </div>\r\n          </div>\r\n        ) : null}\r\n        {this.state.displayImagePreview ? (\r\n          <ImagePreview\r\n            deleteCapturedImage={this.deleteCapturedImage}\r\n            capturedImages={this.state.capturedImages}\r\n            closeImagePreview={this.closeImagePreview}\r\n          />\r\n        ) : null}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Camera;\r\n"]},"metadata":{},"sourceType":"module"}